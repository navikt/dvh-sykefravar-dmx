{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2026-01-22T12:31:02.585456Z", "invocation_id": "fb0de927-610f-4efc-ba0d-5bf5778a3196", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.486126Z", "completed_at": "2026-01-22T12:31:01.506615Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.536892Z", "completed_at": "2026-01-22T12:31:01.536924Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0626821517944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_ia_sykefravar__land", "compiled": true, "compiled_code": "/********************************************************\nView til Team PIA\nPost hook for at viewene kan genereres fra Airflow\n*********************************************************/\n\n\n/* Henter siste offentliggjorte periode som har tilgjengeliggjorte data.\nDersom data fra perioden ikke er offentlig enda, hentes ikke disse dataene.\nPubliseringsdatoer ligger i publiseringstabellen, og det gj\u00f8res en sjekk p\u00e5 om\ndenne datoene har blitt passert ved generering av viewet.\nEgentlig tilstrekkelig \u00e5 se p\u00e5 dim_versjon siden en Informatica-jobb sjekker mot\npubliseringstabellen for \u00e5 sette offentlig_flagg, men lar det st\u00e5 som sikkerhet.  */\nwith siste_periode as (\n  select max(b.rapport_periode) periode\n  from dt_kodeverk.dim_versjon  b\n  join dt_kodeverk.publiseringstabell  p on\n      p.rapport_periode = b.rapport_periode and\n      p.tabell_navn = 'IA_PARAM' and\n      p.offentlig_dato < sysdate and\n      b.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n),\n\n/* Sykefrav\u00e6r, kvartalsstatistikk for hele Norge, \u00e9n rad */\nsykefravar_statistikk_land as (\n  select\n    'NO' as land,\n    arstall,\n    kvartal,\n    sum(taptedv) taptedv,\n    sum(muligedv) muligedv,\n    sum(antpers) antpers\nfrom dvh_syfra.fak_ia_sykefravar fak\njoin dt_kodeverk.dim_versjon dim on\n    dim.pk_dim_versjon = fak.fk_dim_versjon and\n    dim.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n    and dim.offentlig_flagg = 1 -- siste versjon med status 'GODKJENT' etter tidspunkt for pre-/offentliggj\u00f8ring f\u00e5r flagg 1, eldre tabeller etter rekj\u00f8ringer f\u00e5r flagg 0\nwhere dim.rapport_periode = (select periode from siste_periode) --sjekker at siste periode er den samme som offentliggjort periode\n--where dim.rapport_periode <= (select periode from siste_periode) --sjekker at siste periode ikke er st\u00f8rre enn offentliggjort periode, ved henting av mer data tilbake i tid\n --and dim.rapport_periode > (select periode - 500 from siste_periode) --henter data fra fem \u00e5r tilbake, ikke aktuelt per september 2024\nand fak.rectype = 2 -- Filtrerer for kun rectype 2: VIRKSOMHET (B-nummer), tilsvarende offisiell sykefrav\u00e6rsstatistikk\ngroup by\n    arstall,\n    kvartal\n),\n\nfinal as (\n  select\n    cast(land as varchar2(100)) as land,\n    cast(arstall as number(4,0)) as arstall, --\u00f8nsket som number av Team PIA\n    cast(kvartal as number(1,0)) as kvartal, --\u00f8nsket som number av Team PIA\n    cast(round(taptedv/muligedv * 100, 1) as number(4,1)) as prosent, --\u00f8nsket med \u00e9n desimal av Team PIA\n    cast(taptedv as number(20,6)) as taptedv,\n    cast(muligedv as number(20,6)) as muligedv,\n    cast(antpers as number(7,0)) as antpers\n  from sykefravar_statistikk_land\n)\n\nselect\n  land,\n  arstall,\n  kvartal,\n  prosent,\n  taptedv,\n  muligedv,\n  antpers\nfrom final", "relation_name": "dvh_syfra.agg_ia_sykefravar__land", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.499257Z", "completed_at": "2026-01-22T12:31:01.526200Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.543028Z", "completed_at": "2026-01-22T12:31:01.543046Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06630730628967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_ia_sykefravar__naering", "compiled": true, "compiled_code": "/********************************************************\nView til Team PIA\nPost hook for at viewene kan genereres fra Airflow\n*********************************************************/\n\n\n/* Henter siste offentliggjorte periode som har tilgjengeliggjorte data.\nDersom data fra perioden ikke er offentlig enda, hentes ikke disse dataene.\nPubliseringsdatoer ligger i publiseringstabellen, og det gj\u00f8res en sjekk p\u00e5 om\ndenne datoene har blitt passert ved generering av viewet.\nEgentlig tilstrekkelig \u00e5 se p\u00e5 dim_versjon siden en Informatica-jobb sjekker mot\npubliseringstabellen for \u00e5 sette offentlig_flagg, men lar det st\u00e5 som sikkerhet.  */\nwith siste_periode as (\n  select max(b.rapport_periode) periode\n  from dt_kodeverk.dim_versjon  b\n  join dt_kodeverk.publiseringstabell  p on\n      p.rapport_periode = b.rapport_periode and\n      p.tabell_navn = 'IA_PARAM' and\n      p.offentlig_dato < sysdate and\n      b.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n),\n\n/* Sykefrav\u00e6r, kvartalsstatistikk for n\u00e6ring (2 siffer), \u00e9n rad per n\u00e6ring og varighet*/\nsykefravar_statistikk_naering_per_varighet as (\n  select\n    naring,\n    arstall,\n    kvartal,\n    varighet,\n    sum(taptedv) taptedv,\n    sum(muligedv) muligedv,\n    sum(taptedv_gs) taptedv_gs,\n    sum(antpers) antpers\nfrom dvh_syfra.fak_ia_sykefravar fak\njoin dt_kodeverk.dim_versjon dim on\n    dim.pk_dim_versjon = fak.fk_dim_versjon and\n    dim.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n    and dim.offentlig_flagg = 1 -- siste versjon med status 'GODKJENT' etter tidspunkt for pre-/offentliggj\u00f8ring f\u00e5r flagg 1, eldre tabeller etter rekj\u00f8ringer f\u00e5r flagg 0\nwhere dim.rapport_periode = (select periode from siste_periode) --sjekker at siste periode er den samme som offentliggjort periode\n--where dim.rapport_periode <= (select periode from siste_periode) --sjekker at siste periode ikke er st\u00f8rre enn offentliggjort periode, vet henting av mer data tilbake i tid\n  --and dim.rapport_periode > (select periode - 100 from siste_periode) --henter data fra 1 \u00e5r tilbake\nand fak.rectype = 2 -- Filtrerer for kun rectype 2: VIRKSOMHET (B-nummer), tilsvarende offisiell sykefrav\u00e6rsstatistikk\ngroup by\n    naring,\n    arstall,\n    kvartal,\n    varighet\n),\n\n/* Sykefrav\u00e6r, kvartalsstatistikk for n\u00e6ring (2 siffer), \u00e9n rad per n\u00e6ring*/\nsykefravar_statistikk_naering as (\n  select\n    naring,\n    arstall,\n    kvartal,\n    sum(taptedv) taptedv,\n    sum(muligedv) muligedv,\n    sum(taptedv_gs) taptedv_gs,\n    sum(antpers) antpers\n  from sykefravar_statistikk_naering_per_varighet\n  group by\n    naring,\n    arstall,\n    kvartal\n),\n\n/* Summerer tapte dagsverk per varighet som egne kolonner,\nslik at granulariteten havner p\u00e5 n\u00e6ring, og ikke n\u00e6ring og varighet */\ntapte_dagsverk_per_varighet_pivotert as (\n  select * from (\n    select\n      naring,\n      arstall,\n      kvartal,\n      varighet,\n      taptedv\n    from sykefravar_statistikk_naering_per_varighet\n  )\n  PIVOT\n  (\n    sum(taptedv)\n    for varighet in (\n      'A' as varighet_A,\n      'B' as varighet_B,\n      'C' as varighet_C,\n      'D' as varighet_D,\n      'E' as varighet_E,\n      'F' as varighet_F)\n  )\n\n),\n\n/* Joiner statistikk per n\u00e6ring med aggregeringen p\u00e5 varighet\nfor full statistikk */\nsykefravar_statistikk_naering_med_varighet as (\n  select\n    s.naring,\n    s.arstall,\n    s.kvartal,\n    round((s.taptedv/NULLIF(s.muligedv, 0)) * 100, 1) as prosent,\n    s.taptedv,\n    s.muligedv,\n    s.taptedv_gs,\n    s.antpers as antpers,\n    td.varighet_A as varighet_A,\n    td.varighet_B as varighet_B,\n    td.varighet_C as varighet_C,\n    td.varighet_D as varighet_D,\n    td.varighet_E as varighet_E,\n    td.varighet_F as varighet_F\n  from sykefravar_statistikk_naering s\n  left join tapte_dagsverk_per_varighet_pivotert td on\n    s.naring=td.naring and s.arstall=td.arstall and s.kvartal=td.kvartal\n\n),\n\nfinal as (\n  select\n    cast(naring as varchar2(100)) as naring,\n    cast(arstall as number(4)) as arstall, --\u00f8nsket som number av Team PIA\n    cast(kvartal as number(1)) as kvartal, --\u00f8nsket som number av Team PIA\n    cast(round(taptedv/muligedv * 100, 1) as number(4,1)) as prosent, --\u00f8nsket med \u00e9n desimal av Team PIA\n    cast(taptedv as number(20,6)) as taptedv,\n    cast(muligedv as number(20,6)) as muligedv,\n    cast(taptedv_gs as number(20,6)) as taptedv_gs,\n    cast(varighet_A as number(20,6)) as varighet_A,\n    cast(varighet_B as number(20,6)) as varighet_B,\n    cast(varighet_C as number(20,6)) as varighet_C,\n    cast(varighet_D as number(20,6)) as varighet_D,\n    cast(varighet_E as number(20,6)) as varighet_E,\n    cast(varighet_F as number(20,6)) as varighet_F,\n    cast(antpers as number(7,0)) as antpers\n  from sykefravar_statistikk_naering_med_varighet\n)\n\nselect\n  naring,\n  arstall,\n  kvartal,\n  prosent,\n  taptedv,\n  muligedv,\n  taptedv_gs,\n  varighet_A,\n  varighet_B,\n  varighet_C,\n  varighet_D,\n  varighet_E,\n  varighet_F,\n  antpers\nfrom final", "relation_name": "dvh_syfra.agg_ia_sykefravar__naering", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.507127Z", "completed_at": "2026-01-22T12:31:01.541390Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.550236Z", "completed_at": "2026-01-22T12:31:01.550248Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06847882270812988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_ia_sykefravar__naeringskode", "compiled": true, "compiled_code": "/********************************************************\nView til Team PIA\nPost hook for at viewene kan genereres fra Airflow\n*********************************************************/\n\n\n/* Henter siste offentliggjorte periode som har tilgjengeliggjorte data.\nDersom data fra perioden ikke er offentlig enda, hentes ikke disse dataene.\nPubliseringsdatoer ligger i publiseringstabellen, og det gj\u00f8res en sjekk p\u00e5 om\ndenne datoene har blitt passert ved generering av viewet.\nEgentlig tilstrekkelig \u00e5 se p\u00e5 dim_versjon siden en Informatica-jobb sjekker mot\npubliseringstabellen for \u00e5 sette offentlig_flagg, men lar det st\u00e5 som sikkerhet.  */\nwith siste_periode as (\n  select max(b.rapport_periode) periode\n  from dt_kodeverk.dim_versjon  b\n  join dt_kodeverk.publiseringstabell  p on\n      p.rapport_periode = b.rapport_periode and\n      p.tabell_navn = 'IA_PARAM' and\n      p.offentlig_dato < sysdate and\n      b.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n),\n\n/* Sykefrav\u00e6r, kvartalsstatistikk for n\u00e6ringskode (5 siffer), \u00e9n rad per n\u00e6ringskode og varighet*/\nsykefravar_statistikk_naeringskode_per_varighet as (\n  select\n    naering_kode_sn2007 as naering_kode,\n    arstall,\n    kvartal,\n    varighet,\n    sum(taptedv) taptedv,\n    sum(muligedv) muligedv,\n    sum(taptedv_gs) taptedv_gs,\n    sum(antpers) antpers\nfrom dvh_syfra.fak_ia_sykefravar fak\njoin dt_kodeverk.dim_versjon dim on\n    dim.pk_dim_versjon = fak.fk_dim_versjon and\n    dim.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n    and dim.offentlig_flagg = 1 -- siste versjon med status 'GODKJENT' etter tidspunkt for pre-/offentliggj\u00f8ring f\u00e5r flagg 1, eldre tabeller etter rekj\u00f8ringer f\u00e5r flagg 0\nwhere dim.rapport_periode = (select periode from siste_periode) --sjekker at siste periode er den samme som offentliggjort periode\n--where dim.rapport_periode <= (select periode from siste_periode) --sjekker at siste periode ikke er st\u00f8rre enn offentliggjort periode, vet henting av mer data tilbake i tid\n  --and dim.rapport_periode > (select periode - 100 from siste_periode) --henter data fra 1 \u00e5r tilbake\nand fak.rectype = 2 -- Filtrerer for kun rectype 2: VIRKSOMHET (B-nummer), tilsvarende offisiell sykefrav\u00e6rsstatistikk\ngroup by\n    naering_kode_sn2007,\n    arstall,\n    kvartal,\n    varighet\n),\n\n/* Sykefrav\u00e6r, kvartalsstatistikk for n\u00e6ringskode (5 siffer), \u00e9n rad per n\u00e6ring*/\nsykefravar_statistikk_naeringskode as (\n  select\n    naering_kode,\n    arstall,\n    kvartal,\n    sum(taptedv) taptedv,\n    sum(muligedv) muligedv,\n    sum(taptedv_gs) taptedv_gs,\n    sum(antpers) antpers\n  from sykefravar_statistikk_naeringskode_per_varighet\n  group by\n    naering_kode,\n    arstall,\n    kvartal\n),\n\n/* Summerer tapte dagsverk per varighet som egne kolonner,\nslik at granulariteten havner p\u00e5 n\u00e6ringskode, og ikke n\u00e6ringskode og varighet */\ntapte_dagsverk_per_varighet_pivotert as (\n  select * from (\n    select\n      naering_kode,\n      arstall,\n      kvartal,\n      varighet,\n      taptedv\n    from sykefravar_statistikk_naeringskode_per_varighet\n  )\n  PIVOT\n  (\n    sum(taptedv)\n    for varighet in (\n      'A' as varighet_A,\n      'B' as varighet_B,\n      'C' as varighet_C,\n      'D' as varighet_D,\n      'E' as varighet_E,\n      'F' as varighet_F)\n  )\n\n),\n\n/* Joiner statistikk per n\u00e6ringskode med aggregeringen p\u00e5 varighet\nfor full statistikk */\nsykefravar_statistikk_naeringskode_med_varighet as (\n  select\n    s.naering_kode,\n    s.arstall,\n    s.kvartal,\n    round((s.taptedv/NULLIF(s.muligedv, 0)) * 100, 1) as prosent,\n    s.taptedv,\n    s.muligedv,\n    s.taptedv_gs,\n    s.antpers as antpers,\n    td.varighet_A as varighet_A,\n    td.varighet_B as varighet_B,\n    td.varighet_C as varighet_C,\n    td.varighet_D as varighet_D,\n    td.varighet_E as varighet_E,\n    td.varighet_F as varighet_F\n  from sykefravar_statistikk_naeringskode s\n  left join tapte_dagsverk_per_varighet_pivotert td on\n    s.naering_kode=td.naering_kode and s.arstall=td.arstall and s.kvartal=td.kvartal\n\n),\n\nfinal as (\n  select\n    cast(naering_kode as varchar2(100)) as naering_kode,\n    cast(arstall as number(4)) as arstall, --\u00f8nsket som number av Team PIA\n    cast(kvartal as number(1)) as kvartal, --\u00f8nsket som number av Team PIA\n    cast(round(taptedv/muligedv * 100, 1) as number(4,1)) as prosent, --\u00f8nsket med \u00e9n desimal av Team PIA\n    cast(taptedv as number(20,6)) as taptedv,\n    cast(muligedv as number(20,6)) as muligedv,\n    cast(taptedv_gs as number(20,6)) as taptedv_gs,\n    cast(varighet_A as number(20,6)) as varighet_A,\n    cast(varighet_B as number(20,6)) as varighet_B,\n    cast(varighet_C as number(20,6)) as varighet_C,\n    cast(varighet_D as number(20,6)) as varighet_D,\n    cast(varighet_E as number(20,6)) as varighet_E,\n    cast(varighet_F as number(20,6)) as varighet_F,\n    cast(antpers as number(7,0)) as antpers\n  from sykefravar_statistikk_naeringskode_med_varighet\n\n)\n\nselect\n  naering_kode,\n  arstall,\n  kvartal,\n  prosent,\n  taptedv,\n  muligedv,\n  taptedv_gs,\n  varighet_A,\n  varighet_B,\n  varighet_C,\n  varighet_D,\n  varighet_E,\n  varighet_F,\n  antpers\nfrom final", "relation_name": "dvh_syfra.agg_ia_sykefravar__naeringskode", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.512570Z", "completed_at": "2026-01-22T12:31:01.542229Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.552060Z", "completed_at": "2026-01-22T12:31:01.552074Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06928730010986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_ia_sykefravar__sektor", "compiled": true, "compiled_code": "/********************************************************\nView til Team PIA\nPost hook for at viewene kan genereres fra Airflow\n*********************************************************/\n\n\n/* Henter siste offentliggjorte periode som har tilgjengeliggjorte data.\nDersom data fra perioden ikke er offentlig enda, hentes ikke disse dataene.\nPubliseringsdatoer ligger i publiseringstabellen, og det gj\u00f8res en sjekk p\u00e5 om\ndenne datoene har blitt passert ved generering av viewet.\nEgentlig tilstrekkelig \u00e5 se p\u00e5 dim_versjon siden en Informatica-jobb sjekker mot\npubliseringstabellen for \u00e5 sette offentlig_flagg, men lar det st\u00e5 som sikkerhet.  */\nwith siste_periode as (\n  select max(b.rapport_periode) periode\n  from dt_kodeverk.dim_versjon  b\n  join dt_kodeverk.publiseringstabell  p on\n      p.rapport_periode = b.rapport_periode and\n      p.tabell_navn = 'IA_PARAM' and\n      p.offentlig_dato < sysdate and\n      b.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n),\n\n/* Sykefrav\u00e6r, kvartalsstatistikk for sektor, \u00e9n rad per sektor*/\nsykefravar_statistikk_sektor as (\n  select\n    sektor,\n    arstall,\n    kvartal,\n    sum(taptedv) taptedv,\n    sum(muligedv) muligedv,\n    sum(antpers) antpers\nfrom dvh_syfra.fak_ia_sykefravar fak\njoin dt_kodeverk.dim_versjon dim on\n    dim.pk_dim_versjon = fak.fk_dim_versjon and\n    dim.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n    and dim.offentlig_flagg = 1 -- siste versjon med status 'GODKJENT' etter tidspunkt for pre-/offentliggj\u00f8ring f\u00e5r flagg 1, eldre tabeller etter rekj\u00f8ringer f\u00e5r flagg 0\nwhere dim.rapport_periode = (select periode from siste_periode) --sjekker at siste periode er den samme som offentliggjort periode\n--where dim.rapport_periode <= (select periode from siste_periode) --sjekker at siste periode ikke er st\u00f8rre enn offentliggjort periode, vet henting av mer data tilbake i tid\n-- and dim.rapport_periode > (select periode - 500 from siste_periode) --henter data fra fem \u00e5r tilbake, ikke aktuelt per september 2024\nand fak.rectype = 2 -- Filtrerer for kun rectype 2: VIRKSOMHET (B-nummer), tilsvarende offisiell sykefrav\u00e6rsstatistikk\ngroup by\n    sektor,\n    arstall,\n    kvartal\n),\n\nfinal as (\n  select\n    cast(sektor as varchar2(100)) as sektor,\n    cast(arstall as number(4)) as arstall, --\u00f8nsket som number av Team PIA\n    cast(kvartal as number(1)) as kvartal, --\u00f8nsket som number av Team PIA\n    cast(round(taptedv/muligedv * 100, 1) as number(4,1)) as prosent, --\u00f8nsket med \u00e9n desimal av Team PIA\n    cast(taptedv as number(20,6)) as taptedv,\n    cast(muligedv as number(20,6)) as muligedv,\n    cast(antpers as number(7,0)) as antpers\n  from sykefravar_statistikk_sektor\n)\n\nselect\n  sektor,\n  arstall,\n  kvartal,\n  prosent,\n  taptedv,\n  muligedv,\n  antpers\nfrom final", "relation_name": "dvh_syfra.agg_ia_sykefravar__sektor", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.516805Z", "completed_at": "2026-01-22T12:31:01.543867Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.553635Z", "completed_at": "2026-01-22T12:31:01.553646Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06999063491821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_ia_sykefravar__virksomhet", "compiled": true, "compiled_code": "/********************************************************\nView til Team PIA\nPost hook for at viewene kan genereres fra Airflow\n*********************************************************/\n\n\n/* Henter siste offentliggjorte periode som har tilgjengeliggjorte data.\nDersom data fra perioden ikke er offentlig enda, hentes ikke disse dataene.\nPubliseringsdatoer ligger i publiseringstabellen, og det gj\u00f8res en sjekk p\u00e5 om\ndenne datoene har blitt passert ved generering av viewet.\nEgentlig tilstrekkelig \u00e5 se p\u00e5 dim_versjon siden en Informatica-jobb sjekker mot\npubliseringstabellen for \u00e5 sette offentlig_flagg, men lar det st\u00e5 som sikkerhet.  */\nwith siste_periode as (\n  select max(b.rapport_periode) periode\n  from dt_kodeverk.dim_versjon  b\n  join dt_kodeverk.publiseringstabell  p on\n      p.rapport_periode = b.rapport_periode and\n      p.tabell_navn = 'IA_PARAM' and\n      p.offentlig_dato < sysdate and\n      b.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n),\n\n/* Sykefrav\u00e6r, kvartalsstatistikk for virksomhet, \u00e9n rad per virksomhet og varighet*/\nsykefravar_statistikk_virksomhet_per_varighet as (\n    select\n    orgnr,\n    arstall,\n    kvartal,\n    varighet,\n    sum(taptedv) taptedv,\n    sum(muligedv) muligedv,\n    sum(taptedv_gs) taptedv_gs,\n    sum(antpers) antpers,\n    rectype\nfrom dvh_syfra.fak_ia_sykefravar fak\njoin dt_kodeverk.dim_versjon dim on\n    dim.pk_dim_versjon = fak.fk_dim_versjon and\n    dim.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n    and dim.offentlig_flagg = 1 -- siste versjon med status 'GODKJENT' etter tidspunkt for pre-/offentliggj\u00f8ring f\u00e5r flagg 1, eldre tabeller etter rekj\u00f8ringer f\u00e5r flagg 0\nwhere dim.rapport_periode = (select periode from siste_periode) -- sjekker at siste periode er den samme som offentliggjort periode\n--where dim.rapport_periode <= (select periode from siste_periode) -- sjekker at siste periode ikke er st\u00f8rre enn offentliggjort periode, vet henting av mer data tilbake i tid\n-- and dim.rapport_periode > (select periode - 500 from siste_periode) --henter data fra fem \u00e5r tilbake, ikke aktuelt per september 2024\ngroup by\n    orgnr,\n    arstall,\n    kvartal,\n    varighet,\n    rectype\n),\n\n/* Sykefrav\u00e6r, kvartalsstatistikk for virksomhet, \u00e9n rad per virksomhet*/\nsykefravar_statistikk_virksomhet as (\n  select\n      orgnr,\n      arstall,\n      kvartal,\n      sum(taptedv) taptedv,\n      sum(muligedv) muligedv,\n      sum(taptedv_gs) taptedv_gs,\n      sum(antpers) antpers,\n      rectype\n  from sykefravar_statistikk_virksomhet_per_varighet\n  group by\n    orgnr,\n    arstall,\n    kvartal,\n    rectype\n),\n\n/* Summerer tapte dagsverk per varighet som egne kolonner,\nslik at granulariteten havner p\u00e5 virksomhet, og ikke virksomhet og varighet */\ntapte_dagsverk_per_varighet_pivotert as (\n  select * from (\n    select\n      orgnr,\n      arstall,\n      kvartal,\n      varighet,\n      taptedv\n    from sykefravar_statistikk_virksomhet_per_varighet\n  )\n  PIVOT\n  (\n    sum(taptedv)\n    for varighet in (\n      'A' as varighet_A,\n      'B' as varighet_B,\n      'C' as varighet_C,\n      'D' as varighet_D,\n      'E' as varighet_E,\n      'F' as varighet_F)\n  )\n\n),\n\n/* Joiner statistikk per virksomhet med aggregeringen p\u00e5 varighet\nfor full statistikk */\nsykefravar_statistikk_virksomhet_med_varighet as (\n  select\n    s.orgnr,\n    s.arstall,\n    s.kvartal,\n    round((s.taptedv/NULLIF(s.muligedv, 0)) * 100, 1) as prosent,\n    s.taptedv,\n    s.muligedv,\n    s.taptedv_gs,\n    s.antpers as antpers,\n    s.rectype as rectype,\n    td.varighet_A as varighet_A,\n    td.varighet_B as varighet_B,\n    td.varighet_C as varighet_C,\n    td.varighet_D as varighet_D,\n    td.varighet_E as varighet_E,\n    td.varighet_F as varighet_F\n  from sykefravar_statistikk_virksomhet s\n  left join tapte_dagsverk_per_varighet_pivotert td on\n    s.orgnr=td.orgnr and s.arstall=td.arstall and s.kvartal=td.kvartal\n\n),\n\nfinal as (\n  select\n    cast(orgnr as varchar2(100)) as orgnr,\n    cast(arstall as number(4)) as arstall, --\u00f8nsket som number av Team PIA\n    cast(kvartal as number(1)) as kvartal, --\u00f8nsket som number av Team PIA\n    cast( (case when prosent is null then 0 else prosent end ) as number(4,1)) as prosent, --\u00f8nsket med \u00e9n desimal av Team PIA\n    cast(taptedv as number(20,6)) as taptedv,\n    cast(muligedv as number(20,6)) as muligedv,\n    cast(taptedv_gs as number(20,6)) as taptedv_gs,\n    cast(varighet_A as number(20,6)) as varighet_A,\n    cast(varighet_B as number(20,6)) as varighet_B,\n    cast(varighet_C as number(20,6)) as varighet_C,\n    cast(varighet_D as number(20,6)) as varighet_D,\n    cast(varighet_E as number(20,6)) as varighet_E,\n    cast(varighet_F as number(20,6)) as varighet_F,\n    cast(antpers as number(7,0)) as antpers,\n    cast(rectype as varchar2(100)) as rectype\n  from sykefravar_statistikk_virksomhet_med_varighet\n)\n\nselect\n  orgnr,\n  arstall,\n  kvartal,\n  prosent,\n  taptedv,\n  muligedv,\n  taptedv_gs,\n  varighet_A,\n  varighet_B,\n  varighet_C,\n  varighet_D,\n  varighet_E,\n  varighet_F,\n  antpers,\n  rectype\nfrom final", "relation_name": "dvh_syfra.agg_ia_sykefravar__virksomhet", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.521423Z", "completed_at": "2026-01-22T12:31:01.546827Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.554426Z", "completed_at": "2026-01-22T12:31:01.554433Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06965017318725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_ia_sykefravar__virksomhet_metadata", "compiled": true, "compiled_code": "/********************************************************\nView til Team PIA\nPost hook for at viewene kan genereres fra Airflow\n*********************************************************/\n\n\n/* Henter siste offentliggjorte periode som har tilgjengeliggjorte data.\nDersom data fra perioden ikke er offentlig enda, hentes ikke disse dataene.\nPubliseringsdatoer ligger i publiseringstabellen, og det gj\u00f8res en sjekk p\u00e5 om\ndenne datoene har blitt passert ved generering av viewet.\nEgentlig tilstrekkelig \u00e5 se p\u00e5 dim_versjon siden en Informatica-jobb sjekker mot\npubliseringstabellen for \u00e5 sette offentlig_flagg, men lar det st\u00e5 som sikkerhet.  */\nwith siste_periode as (\n  select max(b.rapport_periode) periode\n  from dt_kodeverk.dim_versjon  b\n  join dt_kodeverk.publiseringstabell  p on\n      p.rapport_periode = b.rapport_periode and\n      p.tabell_navn = 'IA_PARAM' and\n      p.offentlig_dato < sysdate and\n      b.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n),\n\nsykefravar_statistikk as (\n  select\n    distinct orgnr,\n    arstall,\n    kvartal,\n    sektor,\n    replace(naring_primar_kode, '.' , '') as primar_naring_kode,\n    rectype,\n    case\n        when kvartal = 1 then to_date(arstall || '0331', 'YYYYMMDD')\n        when kvartal = 2 then to_date(arstall || '0630', 'YYYYMMDD')\n        when kvartal = 3 then to_date(arstall || '0930', 'YYYYMMDD')\n        when kvartal = 4 then to_date(arstall || '1231', 'YYYYMMDD')\n        else to_date('01.01.9999', 'DD.MM.YYYY')\n    end as siste_dag_i_kvartal\nfrom dvh_syfra.fak_ia_sykefravar fak\njoin dt_kodeverk.dim_versjon dim on\n    dim.pk_dim_versjon = fak.fk_dim_versjon and\n    dim.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n    and dim.offentlig_flagg = 1 -- siste versjon med status 'GODKJENT' etter tidspunkt for pre-/offentliggj\u00f8ring f\u00e5r flagg 1, eldre tabeller etter rekj\u00f8ringer f\u00e5r flagg 0\nwhere dim.rapport_periode = (select periode from siste_periode) --sjekker at siste periode er den samme som offentliggjort periode\n--where dim.rapport_periode <= (select periode from siste_periode) --sjekker at siste periode ikke er st\u00f8rre enn offentliggjort periode, vet henting av mer data tilbake i tid\n-- and dim.rapport_periode > (select periode - 500 from siste_periode) --henter data fra fem \u00e5r tilbake, ikke aktuelt per september 2024\n),\n\nsykefravar_statistikk_virksomhet_metadata as (\n  select\n    orgnr,\n    arstall,\n    kvartal,\n    sektor,\n    gruppe3_kode as primar_naring,\n    primar_naring_kode,\n    rectype\n  from sykefravar_statistikk\n  left join dt_p.dim_naering nar on\n    nar.naering_kode = primar_naring_kode\n    and trunc(siste_dag_i_kvartal) between trunc(gyldig_fra_dato) and trunc(gyldig_til_dato)\n    and naeringsstandard = 'SN2007'\n),\n\nfinal as (\n  select\n    cast(orgnr as varchar2(100)) as orgnr,\n    cast(arstall as number(4)) as arstall, --\u00f8nsket som number av Team PIA\n    cast(kvartal as number(1)) as kvartal, --\u00f8nsket som number av Team PIA\n    cast(sektor as varchar2(100)) as sektor,\n    cast(primar_naring as varchar2(100)) as primar_naring,\n    cast(primar_naring_kode as varchar2(100)) as primar_naring_kode,\n    cast(rectype as varchar2(100)) as rectype\n  from sykefravar_statistikk_virksomhet_metadata\n)\n\nselect\n  orgnr,\n  arstall,\n  kvartal,\n  sektor,\n  primar_naring,\n  primar_naring_kode,\n  rectype\nfrom final", "relation_name": "dvh_syfra.agg_ia_sykefravar__virksomhet_metadata", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.526742Z", "completed_at": "2026-01-22T12:31:01.547895Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.555218Z", "completed_at": "2026-01-22T12:31:01.555231Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06979250907897949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_ia_sykefravar_v3", "compiled": true, "compiled_code": "\n\n\nwith siste_periode as (\n  select max(b.rapport_periode) periode\n  from dt_kodeverk.dim_versjon  b\n  join dt_kodeverk.publiseringstabell  p on\n      p.rapport_periode = b.rapport_periode and\n      p.tabell_navn = 'IA_PARAM' and\n      p.offentlig_dato < sysdate and\n      b.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n),\nagg_ia_sykefravar as (\n  select\n    arstall,\n    kvartal,\n    orgnr,\n    naring,\n    naering_kode_sn2007 naering_kode,\n    naring_primar_kode prim\u00e6rn\u00e6ringskode,\n    sektor,\n    varighet,\n    rectype,\n    sum(taptedv) taptedv,\n    sum(muligedv) muligedv,\n    sum(antall_gs) antall_gs,\n    sum(taptedv_gs) taptedv_gs,\n    sum(antpers) antpers\nfrom dvh_syfra.fak_ia_sykefravar fak\njoin dt_kodeverk.dim_versjon dim on\n    dim.pk_dim_versjon = fak.fk_dim_versjon and\n    dim.tabell_navn = 'FAK_IA_SYKEFRAVAR'\n    and dim.offentlig_flagg = 1\nwhere dim.rapport_periode <= (select periode from siste_periode)\nand dim.rapport_periode > (select periode - 500 from siste_periode)\ngroup by\n    arstall,\n    kvartal,\n    orgnr,\n    naring,\n    naering_kode_sn2007,\n    naring_primar_kode,\n    sektor,\n    varighet,\n    rectype\n),\nfinal as(\n  select\n    arstall,\n    kvartal,\n    orgnr,\n    naring,\n    naering_kode,\n    prim\u00e6rn\u00e6ringskode,\n    sektor,\n    varighet,\n    rectype,\n    taptedv,\n    muligedv,\n    antall_gs,\n    taptedv_gs,\n    antpers\n  from agg_ia_sykefravar\n  )\n\nselect * from final", "relation_name": "dvh_syfra.agg_ia_sykefravar_v3", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.533908Z", "completed_at": "2026-01-22T12:31:01.549617Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.556625Z", "completed_at": "2026-01-22T12:31:01.556633Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.06066560745239258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_kodeverk__dim_alder", "compiled": true, "compiled_code": "with source as (\n      select * from dt_kodeverk.dim_alder\n)\n\nselect * from source", "relation_name": "dvh_syfo.felles_dt_kodeverk__dim_alder", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.531087Z", "completed_at": "2026-01-22T12:31:01.550973Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.557998Z", "completed_at": "2026-01-22T12:31:01.558007Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.0626978874206543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.dim_sf_aarsak", "compiled": true, "compiled_code": "WITH source AS (\n  SELECT * FROM dt_p.dim_sf_aarsak\n)\n\nSELECT * FROM source", "relation_name": "dvh_syfo.dim_sf_aarsak", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.538066Z", "completed_at": "2026-01-22T12:31:01.551544Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.558717Z", "completed_at": "2026-01-22T12:31:01.558727Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.06128644943237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_kodeverk__dim_geografi", "compiled": true, "compiled_code": "WITH source AS (\n  SELECT * FROM dt_kodeverk.dim_geografi\n)\n\nSELECT * FROM source", "relation_name": "dvh_syfo.felles_dt_kodeverk__dim_geografi", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.568984Z", "completed_at": "2026-01-22T12:31:01.582695Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.600225Z", "completed_at": "2026-01-22T12:31:01.600241Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04436206817626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_kodeverk__dim_org", "compiled": true, "compiled_code": "with source as (\n      select * from dt_kodeverk.dim_org\n)\n\nselect * from source", "relation_name": "dvh_syfo.felles_dt_kodeverk__dim_org", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.575137Z", "completed_at": "2026-01-22T12:31:01.591620Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.605736Z", "completed_at": "2026-01-22T12:31:01.605749Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.045848846435546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_kodeverk__dim_organisasjon", "compiled": true, "compiled_code": "with source as (\n      select * from dt_kodeverk.dim_organisasjon\n)\n\nselect * from source", "relation_name": "dvh_syfo.felles_dt_kodeverk__dim_organisasjon", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.579728Z", "completed_at": "2026-01-22T12:31:01.601036Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.611232Z", "completed_at": "2026-01-22T12:31:01.611245Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.047078609466552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_kodeverk__dim_tid", "compiled": true, "compiled_code": "with source as (\n      select * from dt_kodeverk.dim_tid\n)\n\nselect * from source", "relation_name": "dvh_syfo.felles_dt_kodeverk__dim_tid", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.583669Z", "completed_at": "2026-01-22T12:31:01.604969Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.612323Z", "completed_at": "2026-01-22T12:31:01.612341Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04639267921447754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_kodeverk__dim_varighet", "compiled": true, "compiled_code": "with source as (\n      select * from dt_kodeverk.dim_varighet\n)\n\nselect * from source", "relation_name": "dvh_syfo.felles_dt_kodeverk__dim_varighet", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.586514Z", "completed_at": "2026-01-22T12:31:01.606995Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.614477Z", "completed_at": "2026-01-22T12:31:01.614487Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.04730486869812012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_p__dim_naering", "compiled": true, "compiled_code": "with source as (\n      select * from dt_p.dim_naering\n)\n\nselect * from source", "relation_name": "dvh_syfo.felles_dt_p__dim_naering", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.589051Z", "completed_at": "2026-01-22T12:31:01.607520Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.615295Z", "completed_at": "2026-01-22T12:31:01.615305Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.04756593704223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_p__dim_virksomhet", "compiled": true, "compiled_code": "with source as (\n      select * from dt_p.dim_virksomhet\n)\nselect * from source", "relation_name": "dvh_syfo.felles_dt_p__dim_virksomhet", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.594713Z", "completed_at": "2026-01-22T12:31:01.609008Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.616119Z", "completed_at": "2026-01-22T12:31:01.616131Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.04419398307800293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_person__dim_person1", "compiled": true, "compiled_code": "WITH source AS (\n  SELECT * FROM dt_person.dim_person1\n)\n\nSELECT * FROM source", "relation_name": "dvh_syfo.felles_dt_person__dim_person1", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.597596Z", "completed_at": "2026-01-22T12:31:01.609995Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.617799Z", "completed_at": "2026-01-22T12:31:01.617821Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.04451918601989746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_person__ident_off_id_til_fk_person1", "compiled": true, "compiled_code": "WITH source AS (\n  SELECT * FROM dt_person.IDENT_OFF_ID_TIL_FK_PERSON1\n  )\n\nSELECT * FROM source", "relation_name": "dvh_syfo.felles_dt_person__ident_off_id_til_fk_person1", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.592093Z", "completed_at": "2026-01-22T12:31:01.610695Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.618982Z", "completed_at": "2026-01-22T12:31:01.618997Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.05066204071044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.felles_dt_p__fak_sf_hendelse_dag", "compiled": true, "compiled_code": "with source as (\n      select * from dt_p.fak_sf_hendelse_dag\n)\n\nselect * from source", "relation_name": "dvh_syfo.felles_dt_p__fak_sf_hendelse_dag", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.601584Z", "completed_at": "2026-01-22T12:31:01.613810Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.621692Z", "completed_at": "2026-01-22T12:31:01.621707Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.04774808883666992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_dvh_sykm__fak_sykm_sykefravar_tilfelle", "compiled": true, "compiled_code": "WITH source AS (\n  SELECT * FROM dvh_sykm.fak_sykm_sykefravar_tilfelle\n)\n\nSELECT * FROM source", "relation_name": "dvh_syfo.fk_dvh_sykm__fak_sykm_sykefravar_tilfelle", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.630281Z", "completed_at": "2026-01-22T12:31:01.722360Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.739252Z", "completed_at": "2026-01-22T12:31:01.739270Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.12250590324401855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_modia__aktivitetskrav_raw", "compiled": true, "compiled_code": "WITH aktivitetskrav_raw AS (\n\n    SELECT * FROM dvh_syfo.raw_aktivitetskrav -- byttest til _patch n\u00e5r overnevnte er i prod\n)\nselect * from aktivitetskrav_raw", "relation_name": "dvh_syfo.fk_modia__aktivitetskrav_raw", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.727142Z", "completed_at": "2026-01-22T12:31:01.728690Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.743285Z", "completed_at": "2026-01-22T12:31:01.743306Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.11478638648986816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dmx_poc.mock_dt_p__dim_organisasjon", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.638384Z", "completed_at": "2026-01-22T12:31:01.729275Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.744885Z", "completed_at": "2026-01-22T12:31:01.744894Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.12381243705749512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_modia__person_oversikt_status_scd", "compiled": true, "compiled_code": "\n\nwith person_oversikt_status as (\n  select\n    uuid,\n    fk_person1,\n    tildelt_enhet,\n    kilde_opprettet_dato,\n    kilde_sist_endret_dato,\n    tildelt_enhet_updated_at,\n    motestatus,\n    kildesystem,\n    lastet_dato,\n    oppdatert_dato as oppdatert_dato_old, --m\u00e5 fjernes fra kildeinnlasting i DAG syfo_kandidater_enhet. Ikke riktig dato.\n    dbt_scd_id,\n    dbt_updated_at,\n    dbt_valid_from,\n    dbt_valid_to\n  from dvh_syfo.fk_syfo_person_oversikt_status__snapshot\n),\n\nnyeste_rader as (\n  select * from person_oversikt_status\n\n\n\n),\n\nrader_til_oppdatering as (\n    select *\n    from (\n        select\n            person_oversikt_status.*,\n            row_number() over ( partition by fk_person1 order by tildelt_enhet_updated_at desc) as radnr\n        from person_oversikt_status)\n\n\n\n),\n\nfinn_neste_dato_for_tildelt_enhet as (\n    select\n       rader_til_oppdatering.*,\n        lead (tildelt_enhet_updated_at, 1) over ( partition by fk_person1 order by tildelt_enhet_updated_at  ) as neste_dato\n    from rader_til_oppdatering\n),\n\nsett_gyldig_kolonner as (\n    select\n        finn_neste_dato_for_tildelt_enhet.*,\n        trunc(tildelt_enhet_updated_at) as gyldig_fra_dato,\n        case when neste_dato is null then trunc(to_date('9999-12-31', 'YYYY-MM-DD')) else trunc(neste_dato - 1) end as gyldig_til_dato,\n        case when dbt_valid_to is null then 1 else 0 end as gyldig_flagg,\n        sysdate as oppdatert_dato\n    from finn_neste_dato_for_tildelt_enhet\n\n),\n\nfinal as (\n  select\n    uuid,\n    fk_person1,\n    tildelt_enhet,\n    kilde_opprettet_dato,\n    kilde_sist_endret_dato,\n    tildelt_enhet_updated_at,\n    motestatus,\n    kildesystem,\n    lastet_dato,\n    oppdatert_dato,\n    gyldig_fra_dato,\n    gyldig_til_dato,\n    gyldig_flagg,\n    dbt_updated_at\n\n  from sett_gyldig_kolonner\n)\n\nselect * from final", "relation_name": "dvh_syfo.fk_modia__person_oversikt_status_scd", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.730271Z", "completed_at": "2026-01-22T12:31:01.732031Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.745663Z", "completed_at": "2026-01-22T12:31:01.745671Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.11651158332824707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dmx_poc.mock_dt_p__dim_tid", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.732745Z", "completed_at": "2026-01-22T12:31:01.734530Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.746383Z", "completed_at": "2026-01-22T12:31:01.746393Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.11673784255981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dmx_poc.mock_dt_person__dim_person1", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.735192Z", "completed_at": "2026-01-22T12:31:01.736773Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.747118Z", "completed_at": "2026-01-22T12:31:01.747128Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.11157655715942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dmx_poc.mock_dt_person__dvh_person_ident_off_id", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.737338Z", "completed_at": "2026-01-22T12:31:01.738556Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.747875Z", "completed_at": "2026-01-22T12:31:01.747882Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.11141061782836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dmx_poc.mock_modia__dialogmote", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.719587Z", "completed_at": "2026-01-22T12:31:01.740348Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.749500Z", "completed_at": "2026-01-22T12:31:01.749510Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1230320930480957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.test__ssb_syfra_teller_kv", "compiled": true, "compiled_code": "SELECT\n  rownum AS id,\n  fnr,\n  TO_NUMBER(\n    gj_uforg, '9D999999999999', 'NLS_NUMERIC_CHARACTERS = ''.,'''\n  ) AS gj_uforg,\n  TO_DATE(s_start, 'YYYYMMDD') AS s_start,\n  TO_DATE(s_stopp, 'YYYYMMDD') AS s_stopp,\n  TO_DATE(p_start, 'YYYYMMDD') AS p_start,\n  TO_DATE(p_slutt, 'YYYYMMDD') AS p_slutt\nFROM dvh_syfra.ssb_syfra_teller_kv", "relation_name": "dvh_syfra.test__ssb_syfra_teller_kv", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.740981Z", "completed_at": "2026-01-22T12:31:01.742531Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.750260Z", "completed_at": "2026-01-22T12:31:01.750268Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.034787893295288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dmx_poc.mock_modia__kandidat", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.723196Z", "completed_at": "2026-01-22T12:31:01.744424Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.751713Z", "completed_at": "2026-01-22T12:31:01.751728Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.12475848197937012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.dmx_poc.dmx_poc-on-run-end-0", "compiled": true, "compiled_code": "\n    -- Oppdater alt med roller i databasen.\n  begin\n    ssr_mtn.update_access_role_privs_in_db;\n  end;\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.787032Z", "completed_at": "2026-01-22T12:31:01.814473Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.815123Z", "completed_at": "2026-01-22T12:31:01.815136Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.053542375564575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo_raw__isdialogmotekandidater_ingen_skjemaendringer", "compiled": true, "compiled_code": "WITH kafka_meldinger AS (\n    SELECT\n        kafka_hash,\n        kafka_message\n    FROM dvh_syfo.raw_isdialogmotekandidat\n    WHERE lastet_dato > sysdate - 1 and dbms_lob.getLength(KAFKA_MESSAGE) > 0\n)\n\n, json_dataguide AS (\n    SELECT\n        kafka_hash,\n        TREAT(JSON_DATAGUIDE(kafka_message) AS JSON) AS json_dataguide\n    FROM kafka_meldinger\n    GROUP BY kafka_hash\n)\n\n, jschema AS (\n    SELECT\n        json_dataguide.json_dataguide.\"o:path\" AS jschema\n    FROM json_dataguide json_dataguide\n    GROUP BY json_dataguide.json_dataguide.\"o:path\"\n)\n\n, final AS (\n    SELECT\n        COUNT(*)\n    FROM jschema\n    HAVING COUNT(*) > 1\n)\n\nSELECT * FROM final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.771638Z", "completed_at": "2026-01-22T12:31:01.777665Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.800539Z", "completed_at": "2026-01-22T12:31:01.800556Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04422903060913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dmx_poc.fk_syfo_person_oversikt_status__snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect * from dvh_syfo.fk_syfo_person_oversikt_status\nwhere tildelt_enhet  != 'None'\n\n", "relation_name": "dvh_syfo.fk_syfo_person_oversikt_status__snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.792676Z", "completed_at": "2026-01-22T12:31:01.816755Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.817807Z", "completed_at": "2026-01-22T12:31:01.817824Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.05480480194091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo_raw_isdialogmote__lest_alle_kafka_meldinger", "compiled": true, "compiled_code": "\n\nSELECT\n    *\nFROM\n    (\n        SELECT\n            kafka_topic,\n            kafka_partisjon,\n            kafka_offset,\n            LEAD(\n                kafka_offset\n            ) OVER(PARTITION BY\n                kafka_topic,\n                kafka_partisjon\n                ORDER BY kafka_offset\n            ) neste\n        FROM\n            DVH_SYFO.raw_isdialogmote\n        WHERE\n            kafka_mottatt_dato > sysdate - 14\n    )\nWHERE\n    neste - kafka_offset > 1\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.784264Z", "completed_at": "2026-01-22T12:31:01.813095Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.821686Z", "completed_at": "2026-01-22T12:31:01.821697Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06106829643249512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__kandidater_lest_alle_kafka_meldinger", "compiled": true, "compiled_code": "\n\nSELECT\n    *\nFROM\n    (\n        SELECT\n            kafka_topic,\n            kafka_partisjon,\n            kafka_offset,\n            LEAD(\n                kafka_offset\n            ) OVER(PARTITION BY\n                kafka_topic,\n                kafka_partisjon\n                ORDER BY kafka_offset\n            ) neste\n        FROM\n            dvh_syfo.raw_isdialogmotekandidat\n        WHERE\n            kafka_mottatt_dato > sysdate - 14\n    )\nWHERE\n    neste - kafka_offset > 1\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.779464Z", "completed_at": "2026-01-22T12:31:01.813709Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.823874Z", "completed_at": "2026-01-22T12:31:01.823888Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0650644302368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__aktivitetskrav_lest_alle_kafka_meldinger", "compiled": true, "compiled_code": "\n\nSELECT\n    *\nFROM\n    (\n        SELECT\n            kafka_topic,\n            kafka_partisjon,\n            kafka_offset,\n            LEAD(\n                kafka_offset\n            ) OVER(PARTITION BY\n                kafka_topic,\n                kafka_partisjon\n                ORDER BY kafka_offset\n            ) neste\n        FROM\n            dvh_syfo.raw_aktivitetskrav\n        WHERE\n            kafka_mottatt_dato > sysdate - 14\n    )\nWHERE\n    neste - kafka_offset > 1\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.806047Z", "completed_at": "2026-01-22T12:31:01.820880Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.828597Z", "completed_at": "2026-01-22T12:31:01.828613Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.06252312660217285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_modia__motebehov", "compiled": true, "compiled_code": "WITH motebehov AS (\n  SELECT * FROM dvh_syfo.fk_motebehov\n)\n,dvh_person_ident AS (\n    SELECT * FROM dvh_syfo.felles_dt_person__ident_off_id_til_fk_person1\n)\n ,join_fk_person_sm AS (\n    SELECT\n        motebehov.*,\n        dvh_person_ident.fk_person1 as fk_person1_sm\n        from motebehov\n    LEFT JOIN dvh_person_ident\n    ON\n      motebehov.sm_fnr = dvh_person_ident.off_id\n      AND dvh_person_ident.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n)\n, join_fk_person1_2 as (\n    select\n    join_fk_person_sm.*,\n    dvh_person_ident.fk_person1 as fk_person1_opprettet_av\n    from join_fk_person_sm\n  left join dvh_person_ident\n    ON\n      join_fk_person_sm.opprettet_av_fnr = dvh_person_ident.off_id\n      AND dvh_person_ident.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n)\n, final as (\n  SELECT\n    MOTEBEHOV_UUID,\n    OPPRETTET_DATO,\n    VIRKSOMHETSNUMMER,\n    HAR_MOTEBEHOV,\n    TILDELT_ENHET,\n    BEHANDLET_TIDSPUNKT,\n    BEHANDLET_VEILEDER_IDENT,\n    SKJEMATYPE,\n    LASTET_DATO,\n    KILDESYSTEM,\n    FK_PERSON1_SM,\n    FK_PERSON1_OPPRETTET_AV\n  FROM join_fk_person1_2\n)\n\nselect * from final", "relation_name": "dvh_syfo.fk_modia__motebehov", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.801760Z", "completed_at": "2026-01-22T12:31:01.822525Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.830179Z", "completed_at": "2026-01-22T12:31:01.830190Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06491613388061523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_modia__kandidat", "compiled": true, "compiled_code": "WITH kandidater AS (\n  SELECT * FROM dvh_syfo.raw_isdialogmotekandidat\n)\n, final AS (\n  SELECT\n    kandidater.kafka_message.uuid as kilde_uuid,\n    CAST(TO_TIMESTAMP(kandidater.kafka_message.createdAt, 'yyyy-mm-dd\"T\"hh24:mi:ss.fftzh:tzm') at TIME ZONE 'CET' as timestamp) AS hendelse_tidspunkt,\n    person.fk_person1 as fk_person1,\n    DECODE(kandidater.kafka_message.kandidat, 'true', 1, 'false', 0) AS kandidat_flagg,\n    kandidater.kafka_message.arsak as hendelse,\n    kandidater.kafka_message.unntakArsak as unntakarsak,\n    TO_DATE(kandidater.kafka_message.tilfelleStart, 'YYYY-MM-DD') as tilfelle_startdato,\n    kandidater.kafka_message.unntakVeilederident as nav_ident,\n    kafka_topic,\n    kafka_partisjon,\n    kafka_offset,\n    kafka_mottatt_dato,\n    lastet_dato,\n    kildesystem\n  FROM kandidater kandidater\n  inner join dvh_syfo.felles_dt_person__ident_off_id_til_fk_person1 person\n          on person.off_id = kandidater.kafka_message.personIdentNumber\n         and person.gyldig_til_dato = to_date('31.12.9999','DD.MM.YYYY') -- henter gyldige\n         and person.skjermet_kode not in (6, 7) -- fjerner skjerma personer\n)\nSELECT * FROM final", "relation_name": "dvh_syfo.fk_modia__kandidat", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.796784Z", "completed_at": "2026-01-22T12:31:01.823079Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.830935Z", "completed_at": "2026-01-22T12:31:01.830945Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06710243225097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_modia__dialogmote", "compiled": true, "compiled_code": "WITH dialogmote AS (\n    select dialogmote.kafka_message.dialogmoteUuid as kilde_uuid,\n    CAST(TO_TIMESTAMP_TZ(dialogmote.kafka_message.dialogmoteTidspunkt, 'YYYY-MM-DD HH24:MI:SS:TZH:TZM') at TIME ZONE 'CET' as timestamp) AS dialogmote_tidspunkt,\n    dialogmote.kafka_message.statusEndringType as hendelse,\n    CAST(TO_TIMESTAMP_TZ(dialogmote.kafka_message.statusEndringTidspunkt, 'YYYY-MM-DD HH24:MI:SS.FF:TZH:TZM') at TIME ZONE 'CET' as timestamp) AS hendelse_tidspunkt,\n    person.fk_person1 as fk_person1,\n    dialogmote.kafka_message.virksomhetsnummer as virksomhetsnr,\n    dialogmote.kafka_message.enhetNr as enhet_nr,\n    dialogmote.kafka_message.navIdent as nav_ident,\n    CAST(TO_TIMESTAMP_TZ(dialogmote.kafka_message.tilfelleStartdato, 'YYYY-MM-DD HH24:MI:SS:TZH:TZM') at TIME ZONE 'CET' as timestamp) AS tilfelle_startdato,\n    DECODE(dialogmote.kafka_message.arbeidstaker, 'true', 1, 'false', 0) AS arbeidstaker_flagg,\n    DECODE(dialogmote.kafka_message.arbeidsgiver, 'true', 1, 'false', 0) AS arbeidsgiver_flagg,\n    DECODE(dialogmote.kafka_message.sykmelder, 'true', 1, 'false', 0) AS sykmelder_flagg,\n    dialogmote.kafka_topic,\n    dialogmote.kafka_partisjon,\n    dialogmote.kafka_offset,\n    dialogmote.kafka_mottatt_dato,\n    dialogmote.lastet_dato,\n    dialogmote.kildesystem\n  from dvh_syfo.raw_isdialogmote dialogmote\n  inner join dvh_syfo.felles_dt_person__ident_off_id_til_fk_person1 person\n          on person.off_id = dialogmote.kafka_message.personIdent\n         and person.gyldig_til_dato = to_date('31.12.9999','DD.MM.YYYY') -- henter gyldige\n         and person.skjermet_kode not in (6, 7) -- fjerner skjerma personer\n),\n\nfinal as (\n  select kilde_uuid,\n         dialogmote_tidspunkt,\n         hendelse,\n         hendelse_tidspunkt,\n         fk_person1,\n         virksomhetsnr,\n         enhet_nr,\n         nav_ident,\n         tilfelle_startdato,\n         arbeidstaker_flagg,\n         arbeidsgiver_flagg,\n         sykmelder_flagg,\n         kafka_topic,\n         kafka_partisjon,\n         kafka_offset,\n         kafka_mottatt_dato,\n         lastet_dato,\n         kildesystem\n  from dialogmote\n)\n\nselect * from final", "relation_name": "dvh_syfo.fk_modia__dialogmote", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.809461Z", "completed_at": "2026-01-22T12:31:01.824761Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.832322Z", "completed_at": "2026-01-22T12:31:01.832332Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06472206115722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fak_syfo_hendelse_varighet", "compiled": true, "compiled_code": "WITH fak_syfo_hendelse_org_v AS (\n  SELECT * FROM dvh_syfo.felles_dt_p__fak_sf_hendelse_dag\n),\n\ndim_varighet AS (\n    SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_varighet\n),\n\nfinal AS (\n    SELECT\n           --fak_syfo_hendelse_org_v.fk_dim_naering,\n           --fak_syfo_hendelse_org_v.fk_dim_organisasjon,\n           fak_syfo_hendelse_org_v.*,\n           dim_varighet.pk_dim_varighet as fk_dim_varighet\n\n    FROM fak_syfo_hendelse_org_v\n    LEFT JOIN dim_varighet\n    ON dim_varighet.varighet_dager =\n    (trunc(fak_syfo_hendelse_org_v.fK_DIM_TID_DATO_HENDELSE) -\n     trunc(fak_syfo_hendelse_org_v.FK_DIM_TID_IDENT_DATO))\n)\n\nSELECt final.* FROM final", "relation_name": "dvh_syfo.fak_syfo_hendelse_varighet", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.789674Z", "completed_at": "2026-01-22T12:31:01.826962Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.834341Z", "completed_at": "2026-01-22T12:31:01.834351Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.07179927825927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo_raw_isdialogmote__ingen_skjemaendringer", "compiled": true, "compiled_code": "WITH kafka_meldinger AS (\n    SELECT\n        kafka_hash,\n        kafka_message\n    FROM DVH_SYFO.raw_isdialogmote\n    WHERE lastet_dato > sysdate - 1 and kafka_message is not null\n)\n\n, json_dataguide AS (\n    SELECT\n        kafka_hash,\n        TREAT(JSON_DATAGUIDE(kafka_message) AS JSON) AS json_dataguide\n    FROM kafka_meldinger\n    GROUP BY kafka_hash\n)\n\n, jschema AS (\n    SELECT\n        json_dataguide.json_dataguide.\"o:path\" AS jschema\n    FROM json_dataguide json_dataguide\n    GROUP BY json_dataguide.json_dataguide.\"o:path\"\n)\n\n, final AS (\n    SELECT\n        COUNT(*)\n    FROM jschema\n    HAVING COUNT(*) > 1\n)\n\nSELECT * FROM final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.846919Z", "completed_at": "2026-01-22T12:31:01.870761Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.897740Z", "completed_at": "2026-01-22T12:31:01.897760Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06490898132324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_dialogmote__omkode_arena_hendelse", "compiled": true, "compiled_code": "WITH arena AS (\n  SELECT * FROM dvh_syfo.felles_dt_p__fak_sf_hendelse_dag\n)\n\n,final AS (\n  SELECT\n    arena.fk_person1\n    ,TO_DATE(TO_CHAR(arena.fk_dim_tid_ident_dato), 'YYYYMMDD') AS tilfelle_startdato\n    ,TO_DATE(TO_CHAR(arena.fk_dim_tid_dato_hendelse), 'YYYYMMDD') AS hendelse_tidspunkt\n    ,\n    CASE\n      when arena.fk_dim_sf_hendelsestype in (105,179) then\n      TO_DATE(TO_CHAR(arena.fk_dim_tid_dato_hendelse), 'YYYYMMDD')\n    END AS dialogmote_tidspunkt\n    ,arena.ansv_kontor AS enhet_nr\n    ,DECODE(arena.fk_dim_sf_hendelsestype\n      ,105 ,'FERDIGSTILT'\n      ,179 ,'FERDIGSTILT'\n      ,93  ,'STOPPUNKT'\n      ,108 ,'UNNTAK'\n    ) AS hendelse\n    ,arena.kildesystem\n    ,arena.pk_fak_sf_hendelse_dag AS kilde_uuid\n  FROM arena\n  WHERE\n    arena.fk_dim_sf_hendelsestype IN (\n      105  -- DM2\n      ,179 -- DM3\n      ,93  -- Kandidat DM2\n      ,108 -- Unntak DM2\n    )\n    AND arena.gyldig_flagg = 1\n    AND arena.kildesystem = 'ARENA'\n    AND arena.fk_dim_tid_ident_dato > 20190000 and arena.fk_dim_tid_ident_dato < 20240000 -- TODO: Filtrer bort data som er d\u00e5rlige\n)\n\nselect * from final", "relation_name": "dvh_syfo.mk_dialogmote__omkode_arena_hendelse", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.850362Z", "completed_at": "2026-01-22T12:31:01.871244Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.898943Z", "completed_at": "2026-01-22T12:31:01.898959Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06548929214477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.stg_fak_sf_hendelse_dag", "compiled": true, "compiled_code": "\n\nwith source_fak_sf_hendelse as (\n    select  *  from dvh_syfo.felles_dt_p__fak_sf_hendelse_dag\n),\n\nfinal as (\n    --select to_char(source_fak_sf_hendelse.pk_fak_sf_hendelse_dag) ||\n    select to_char(source_fak_sf_hendelse.fk_dim_tid_dato_hendelse) ||\n     'a' ||to_char(source_fak_sf_hendelse.fk_person1) as key_dmx_arena,\n     source_fak_sf_hendelse.*\n    from source_fak_sf_hendelse where FK_DIM_SF_HENDELSESTYPE in (105, 179) and\n    fk_dim_tid_dato_hendelse>= '20210101'\n    and GYLDIG_FLAGG = 1 and source_fak_sf_hendelse.Kildesystem like 'ARENA%'\n)\n\nselect * from final", "relation_name": "dvh_syfo.stg_fak_sf_hendelse_dag", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.857495Z", "completed_at": "2026-01-22T12:31:01.875282Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.900196Z", "completed_at": "2026-01-22T12:31:01.900207Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.06512832641601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.stg_fak_sykm_sykefravar_tilfelle", "compiled": true, "compiled_code": "with fak_sykm_sykefravar_tilfelle as (\n    select  *  from dvh_syfo.fk_dvh_sykm__fak_sykm_sykefravar_tilfelle\n),\n\n\nfinal as (\n    select * from fak_sykm_sykefravar_tilfelle\n    where  extract(year from sykefravar_fra_dato) > 2021\n)\n\nselect * from final", "relation_name": "dvh_syfo.stg_fak_sykm_sykefravar_tilfelle", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.861378Z", "completed_at": "2026-01-22T12:31:01.882619Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.902085Z", "completed_at": "2026-01-22T12:31:01.902095Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06571435928344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_modia__aktivitetskrav", "compiled": true, "compiled_code": "\n\nWITH aktivitetskrav AS (\n  SELECT * FROM dvh_syfo.fk_modia__aktivitetskrav_raw\n)\n,dvh_person_ident AS (\n    SELECT * FROM dvh_syfo.felles_dt_person__ident_off_id_til_fk_person1\n)\n, aktivitet_dta AS (\n  SELECT\n      JSON_VALUE(aktivitetskrav.KAFKA_MESSAGE, '$.uuid') AS kilde_uuid,\n      JSON_VALUE(aktivitetskrav.KAFKA_MESSAGE, '$.personIdent') AS personIdent,\n      CAST(TO_TIMESTAMP_TZ(JSON_VALUE(aktivitetskrav.KAFKA_MESSAGE, '$.stoppunktAt'), 'YYYY-MM-DD HH24:MI:SS.FF:TZH:TZM') at TIME ZONE 'CET' as timestamp) AS stoppunktAt,\n       CAST(TO_TIMESTAMP_TZ(JSON_VALUE(aktivitetskrav.KAFKA_MESSAGE,'$.createdAt'), 'yyyy-mm-dd\"T\"hh24:mi:ss.fftzh:tzm\"Z\"') at TIME ZONE 'CET' as timestamp) as createdAt,\n        JSON_VALUE(aktivitetskrav.KAFKA_MESSAGE, '$.status') as status,\n        --JSON_TABLE(aktivitetskrav.KAFKA_MESSAGE, '$.arsaker[*]'\n        -- COLUMNS (arsaker VARCHAR2(100) PATH '$')) AS arsaker,\n         JSON_VALUE(aktivitetskrav.KAFKA_MESSAGE, '$.arsaker[0]') AS arsaker,\n        JSON_VALUE(aktivitetskrav.KAFKA_MESSAGE, '$.arsaker[1]') AS arsaker1,\n        JSON_VALUE(aktivitetskrav.KAFKA_MESSAGE, '$.arsaker[2]') AS arsaker2,\n        json_value(aktivitetskrav.kafka_message,'$.updatedBy') as updatedBy,\n        CAST(TO_TIMESTAMP_TZ(JSON_VALUE(aktivitetskrav.kafka_message,'$.sistVurdert'), 'yyyy-mm-dd\"T\"hh24:mi:ss.fftzh:tzm\"Z\"') at TIME ZONE 'CET' as timestamp) AS sistVurdert,\n    kafka_topic,\n    kafka_partisjon,\n    kafka_offset,\n    kafka_mottatt_dato,\n    oppdatert_dato,\n    lastet_dato,\n    kildesystem\n  FROM aktivitetskrav aktivitetskrav\n)\n,med_fkPerson1 as (\n  SELECT\n    kilde_uuid,\n    createdAt,\n    status,\n    arsaker,\n    arsaker1,\n    arsaker2,\n    updatedBy,\n    stoppunktAt,\n    sistVurdert,\n    kafka_topic,\n    kafka_partisjon,\n    kafka_offset,\n    kafka_mottatt_dato,\n    oppdatert_dato,\n    lastet_dato,\n    kildesystem,\n    dvh_person_ident.fk_person1 as fk_person1\n  from aktivitet_dta\n  LEFT JOIN dvh_person_ident\n  ON\n      aktivitet_dta.personIdent = dvh_person_ident.off_id\n      AND dvh_person_ident.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n)\n,final as (\nSELECT med_fkPerson1.* FROM med_fkPerson1\n)\n\nselect * from final", "relation_name": "dvh_syfo.fk_modia__aktivitetskrav", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.866271Z", "completed_at": "2026-01-22T12:31:01.893027Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.904140Z", "completed_at": "2026-01-22T12:31:01.904149Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06515169143676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.gj_uforg_har_maks_ti_desimaler", "compiled": true, "compiled_code": "SELECT gj_uforg\nFROM dvh_syfra.test__ssb_syfra_teller_kv\nWHERE (LENGTH((gj_uforg) - TRUNC(gj_uforg)) - 1) > 10", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.872060Z", "completed_at": "2026-01-22T12:31:01.901238Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.908267Z", "completed_at": "2026-01-22T12:31:01.908279Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.0649559497833252, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.gj_uforg_mellom_0.2_og_1", "compiled": true, "compiled_code": "SELECT gj_uforg\nFROM dvh_syfra.test__ssb_syfra_teller_kv\nWHERE gj_uforg NOT BETWEEN 0.2 AND 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.876030Z", "completed_at": "2026-01-22T12:31:01.902851Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.909946Z", "completed_at": "2026-01-22T12:31:01.909955Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06548476219177246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.ikke_overlappende_s_start_og_s_slutt", "compiled": true, "compiled_code": "SELECT\n  tilfelle.s_start,\n  tilfelle.s_stopp\nFROM dvh_syfra.test__ssb_syfra_teller_kv tilfelle\nLEFT JOIN dvh_syfra.test__ssb_syfra_teller_kv ref_tilfelle ON\n  tilfelle.id != ref_tilfelle.id\n  AND tilfelle.fnr = ref_tilfelle.fnr\nWHERE\n  tilfelle.s_start BETWEEN ref_tilfelle.s_start AND ref_tilfelle.s_stopp\n  OR tilfelle.s_stopp BETWEEN ref_tilfelle.s_start AND ref_tilfelle.s_stopp", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.879575Z", "completed_at": "2026-01-22T12:31:01.903509Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.910781Z", "completed_at": "2026-01-22T12:31:01.910791Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06579923629760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.not_null_i_s_start_og_s_stopp", "compiled": true, "compiled_code": "SELECT *\nFROM dvh_syfra.test__ssb_syfra_teller_kv\nWHERE s_stopp is NULL OR s_start is NULL", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.883331Z", "completed_at": "2026-01-22T12:31:01.905096Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.912328Z", "completed_at": "2026-01-22T12:31:01.912337Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0661475658416748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.not_null_test__ssb_syfra_teller_kv_fnr.04091e79e4", "compiled": true, "compiled_code": "\n    \n    \n\nselect * from (\nselect count(*) as null_count\nfrom dvh_syfra.test__ssb_syfra_teller_kv\nwhere fnr is null) c where c.null_count != 0\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.893849Z", "completed_at": "2026-01-22T12:31:01.906300Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.913740Z", "completed_at": "2026-01-22T12:31:01.913748Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.05716991424560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.not_null_test__ssb_syfra_teller_kv_gj_uforg.9046d951e1", "compiled": true, "compiled_code": "\n    \n    \n\nselect * from (\nselect count(*) as null_count\nfrom dvh_syfra.test__ssb_syfra_teller_kv\nwhere gj_uforg is null) c where c.null_count != 0\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.926542Z", "completed_at": "2026-01-22T12:31:01.953550Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.973213Z", "completed_at": "2026-01-22T12:31:01.973228Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06025218963623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.not_null_test__ssb_syfra_teller_kv_p_slutt.e95b185a90", "compiled": true, "compiled_code": "\n    \n    \n\nselect * from (\nselect count(*) as null_count\nfrom dvh_syfra.test__ssb_syfra_teller_kv\nwhere p_slutt is null) c where c.null_count != 0\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.938025Z", "completed_at": "2026-01-22T12:31:01.957374Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.974273Z", "completed_at": "2026-01-22T12:31:01.974284Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.05884838104248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.not_null_test__ssb_syfra_teller_kv_s_start.8747613d8a", "compiled": true, "compiled_code": "\n    \n    \n\nselect * from (\nselect count(*) as null_count\nfrom dvh_syfra.test__ssb_syfra_teller_kv\nwhere s_start is null) c where c.null_count != 0\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.931876Z", "completed_at": "2026-01-22T12:31:01.957890Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.975092Z", "completed_at": "2026-01-22T12:31:01.975101Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06049609184265137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.not_null_test__ssb_syfra_teller_kv_p_start.b5c1d4a070", "compiled": true, "compiled_code": "\n    \n    \n\nselect * from (\nselect count(*) as null_count\nfrom dvh_syfra.test__ssb_syfra_teller_kv\nwhere p_start is null) c where c.null_count != 0\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.943208Z", "completed_at": "2026-01-22T12:31:01.962855Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.976459Z", "completed_at": "2026-01-22T12:31:01.976470Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.059706687927246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.not_null_test__ssb_syfra_teller_kv_s_stopp.4f1075fe39", "compiled": true, "compiled_code": "\n    \n    \n\nselect * from (\nselect count(*) as null_count\nfrom dvh_syfra.test__ssb_syfra_teller_kv\nwhere s_stopp is null) c where c.null_count != 0\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.948933Z", "completed_at": "2026-01-22T12:31:01.972636Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.978782Z", "completed_at": "2026-01-22T12:31:01.978792Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06012272834777832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.s_start_mindre_enn_s_stopp", "compiled": true, "compiled_code": "SELECT s_start\nFROM dvh_syfra.test__ssb_syfra_teller_kv\nWHERE s_start > s_stopp", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.954645Z", "completed_at": "2026-01-22T12:31:01.975855Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.982641Z", "completed_at": "2026-01-22T12:31:01.982656Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.060479164123535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.s_stopp_mindre_enn_fjorten_mnd_etter_p_slutt", "compiled": true, "compiled_code": "SELECT s_stopp\nFROM dvh_syfra.test__ssb_syfra_teller_kv\nWHERE\n  TRUNC(s_stopp) > TRUNC(ADD_MONTHS(p_slutt, 14))", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.958875Z", "completed_at": "2026-01-22T12:31:01.977245Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.984210Z", "completed_at": "2026-01-22T12:31:01.984220Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06079673767089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_modia__kandidat_unntak", "compiled": true, "compiled_code": "WITH kandidater AS (\n  SELECT * FROM dvh_syfo.fk_modia__kandidat\n),\n\nfinal as (\n  select\n    k.kilde_uuid,\n    k.hendelse_tidspunkt,\n    k.fk_person1,\n    k.kandidat_flagg,\n    k.hendelse,\n    k.unntakarsak,\n    k.tilfelle_startdato,\n    nvl(u.created_by, k.nav_ident) as nav_ident,\n    k.kafka_topic,\n    k.kafka_partisjon,\n    k.kafka_offset,\n    k.kafka_mottatt_dato,\n    k.lastet_dato,\n    k.kildesystem\n  from kandidater k\n  left outer join dvh_syfo.fk_dm_unntak_historikk_2023_til_2025 u\n    on k.fk_person1 = u.fk_person1\n    and trunc(k.hendelse_tidspunkt) = u.created_at\n)\n\nselect * from final", "relation_name": "dvh_syfo.fk_modia__kandidat_unntak", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.967044Z", "completed_at": "2026-01-22T12:31:01.978242Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.985132Z", "completed_at": "2026-01-22T12:31:01.985143Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.059586524963378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.cnt_dialogmote", "compiled": true, "compiled_code": "SELECT count(*) as cnt_dialogmote FROM dvh_syfo.fk_modia__dialogmote", "relation_name": "dvh_syfo.cnt_dialogmote", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.969872Z", "completed_at": "2026-01-22T12:31:01.979517Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.986707Z", "completed_at": "2026-01-22T12:31:01.986717Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.055616140365600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fk_modia__dialogmote_patch", "compiled": true, "compiled_code": "/*bytter ut tilfellestartdato som har blitt feil fra kilden*/\n\nwith dialogmote_forkammer as\n(SELECT * FROM dvh_syfo.fk_modia__dialogmote)\n\n, dialogmote_patch as (\n  select dialogmote_forkammer.*,\n  case\n  when kilde_uuid = '92097f17-1e02-4449-8eaf-d5a50d05220e' and hendelse in ('FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-06-01','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen modia hendelse*/\n  when kilde_uuid = 'c7745c33-fdff-42f8-a6dc-5d3dc4aed983' and hendelse in ('INNKALT','NYTT_TID_STED','FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-01-06','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra arena hendelse*/\n  when kilde_uuid = 'b31aef9f-afaa-4d8e-9f31-d9d7d1bb3819' and hendelse in ('FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-08-28','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen modia hendelse*/\n  when kilde_uuid = '57c2abe2-062d-45bd-b51d-898e063cd13b' and hendelse in ('FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-09-08', 'YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen modia hendelse*/\n  when kilde_uuid = '5b3881ac-e5da-4d57-a4e5-5eeb90bf645a' and hendelse in ('INNKALT', 'FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-03-20','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen modia hendelse*/\n  when kilde_uuid = '159d7f6e-4ecf-487d-bf9e-1c9a8fb89e0d' and hendelse in ('FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-02-21','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen modia hendelse*/\n  when kilde_uuid = '9358c264-6871-4bad-b62b-a3245b52530e' and hendelse in ('INNKALT','NYTT_TID_STED','FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2021-12-17','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen modia hendelse*/\n  when kilde_uuid = '4dfdc657-5879-40fc-a096-75d7562298c2' and hendelse in ('FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-08-18','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen modia hendelse*/\n  when kilde_uuid = 'a2e8cd59-9eb4-44c7-bf4a-feb1da44312f' and hendelse in ('FERDIGSTILT', 'INNKALT') then CAST(TO_TIMESTAMP_TZ('2022-01-29','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra arena oppfolging*/\n  when kilde_uuid = 'd6ed14e0-a98f-44fb-a114-88448b372b16' and hendelse in ('INNKALT','NYTT_TID_STED','FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-09-12','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra arena oppfolging*/\n  when kilde_UUid = '812a477c-2543-427f-8cdb-fbef59f36123' and hendelse in ('FERDIGSTILT','INNKALT') then CAST(TO_TIMESTAMP_TZ('2022-02-28','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra arena/infotrygd*/\n  when kilde_uuid = '3b5e4b16-3576-49c4-ba44-2393848e3fc5' and hendelse in ('INNKALT','NYTT_TID_STED','FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-08-12','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra infotrygd/arena, fant ikke noe i sykm*/\n  when kilde_uuid = '1662ee9f-5186-4c5b-a43b-bd0c926d8d19' and hendelse in ('FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2022-09-14','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen dialogmote hendelse*/\n  when kilde_uuid = '7352a6f3-d7e2-4676-a2fe-de0c55f59f68' and hendelse in ('FERDIGSTILT','INNKALT') then  CAST(TO_TIMESTAMP_TZ('2023-01-23','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra sf_oppfolging*/\n  when kilde_uuid = '7574b760-cef4-44a7-9c21-463055fd6a36' and hendelse in ('FERDIGSTILT','INNKALT') then  CAST(TO_TIMESTAMP_TZ('2023-10-09','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra sf_oppfolging og sykm_sykmelding*/\n  when kilde_uuid = 'a5a7e0c1-a7b1-428c-b868-0b747cd51009' and hendelse in ('FERDIGSTILT','INNKALT', 'NYTT_TID_STED') then  CAST(TO_TIMESTAMP_TZ('2024-04-05','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra sykm_sykmelding*/\n  when kilde_uuid = '9f0795df-dd18-4c9a-8720-8eef63fa03f4' and hendelse in ('INNKALT','NYTT_TID_STED','FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2024-09-18','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen dialogmote hendelse*/\n  when kilde_uuid = 'ed082aab-3881-44c6-b386-1cfca0e94199' and hendelse in ('INNKALT','FERDIGSTILT') then CAST(TO_TIMESTAMP_TZ('2025-02-17','YYYY-MM-DD') at TIME ZONE 'CET' as timestamp) /*hentet fra annen dialogmote hendelse*/\n  else tilfelle_startdato\n  end\n  tilfelle_startdato_patch\n  from dialogmote_forkammer\n)\n\n, final AS (\n  SELECT\n    kilde_uuid,\n    dialogmote_tidspunkt,\n    hendelse,\n    hendelse_tidspunkt,\n    fk_person1,\n    virksomhetsnr,\n    enhet_nr,\n    nav_ident,\n    tilfelle_startdato_patch as tilfelle_startdato,\n    arbeidstaker_flagg,\n    arbeidsgiver_flagg,\n    sykmelder_flagg,\n    kafka_topic,\n    kafka_partisjon,\n    kafka_offset,\n    kafka_mottatt_dato,\n    lastet_dato,\n    kildesystem\n  FROM dialogmote_patch\n)\n\nSELECT * FROM final", "relation_name": "dvh_syfo.fk_modia__dialogmote_patch", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.963364Z", "completed_at": "2026-01-22T12:31:01.979903Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:01.987743Z", "completed_at": "2026-01-22T12:31:01.987763Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0638113021850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__kandidat_tidlig_tilfelle_startdato", "compiled": true, "compiled_code": "with final as (\n select 1 from dvh_syfo.fk_modia__kandidat\n    where tilfelle_startdato < to_date('2022-01-01','YYYY-MM-DD')\n    and lastet_dato >= trunc(sysdate) - 1\n)\nselect 1 from final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.002034Z", "completed_at": "2026-01-22T12:31:02.020509Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.050271Z", "completed_at": "2026-01-22T12:31:02.050288Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.06091022491455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__dialogmote_gammal_startdato", "compiled": true, "compiled_code": "with final as (\n select 1 from dvh_syfo.fk_modia__dialogmote\n    where tilfelle_startdato < trunc(sysdate) - 365\n    and lastet_dato >= trunc(sysdate) - 1\n)\nselect 1 from final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:01.998877Z", "completed_at": "2026-01-22T12:31:02.023839Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.066971Z", "completed_at": "2026-01-22T12:31:02.066986Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07833194732666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__dialogmote_dm_tidspunkt_langt_fram", "compiled": true, "compiled_code": "with final as (\n select 1 from dvh_syfo.fk_modia__dialogmote\n    where trunc(dialogmote_tidspunkt) > trunc(sysdate) + 90\n    and lastet_dato >= trunc(sysdate) - 1\n)\nselect 1 from final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.008466Z", "completed_at": "2026-01-22T12:31:02.024448Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.068054Z", "completed_at": "2026-01-22T12:31:02.068070Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07805967330932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__dialogmote_gammalt_dm_tidspunkt", "compiled": true, "compiled_code": "with final as (\n select 1 from dvh_syfo.fk_modia__dialogmote\n    where trunc(dialogmote_tidspunkt) < trunc(sysdate) - 7\n    and lastet_dato >= trunc(sysdate) - 1\n)\nselect 1 from final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.012640Z", "completed_at": "2026-01-22T12:31:02.028886Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.069720Z", "completed_at": "2026-01-22T12:31:02.069730Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07840466499328613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__dialogmote_gammalt_hendelse_tidspunkt", "compiled": true, "compiled_code": "with final as (\n select 1 from dvh_syfo.fk_modia__dialogmote\n    where trunc(hendelse_tidspunkt) < trunc(sysdate) - 7\n    and lastet_dato >= trunc(sysdate) - 1\n)\nselect 1 from final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.015930Z", "completed_at": "2026-01-22T12:31:02.051205Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.071633Z", "completed_at": "2026-01-22T12:31:02.071656Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07909274101257324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__dialogmote_hendelse_tidspunkt_ulik_kafka_dato", "compiled": true, "compiled_code": "with final as (\n select 1 from dvh_syfo.fk_modia__dialogmote\n    where trunc(hendelse_tidspunkt) <> trunc(kafka_mottatt_dato)\n    and lastet_dato >= trunc(sysdate) - 1\n)\nselect 1 from final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.021218Z", "completed_at": "2026-01-22T12:31:02.069019Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.073883Z", "completed_at": "2026-01-22T12:31:02.073892Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.07785272598266602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo__dialogmote_tilfelle_startdato_fram_i_tid", "compiled": true, "compiled_code": "with final as (\n select 1 from dvh_syfo.fk_modia__dialogmote\n    where tilfelle_startdato > trunc(sysdate)\n    and lastet_dato >= trunc(sysdate) - 1\n)\nselect 1 from final", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.025089Z", "completed_at": "2026-01-22T12:31:02.070731Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.075137Z", "completed_at": "2026-01-22T12:31:02.075148Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07803511619567871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_aktivitetskrav__join_sykefravar_tilfelle", "compiled": true, "compiled_code": "WITH aktivitetskrav as (\n  select * from dvh_syfo.fk_modia__aktivitetskrav\n\n),\n\nsykefravar_tilfeller as(\n  select * from dvh_syfo.stg_fak_sykm_sykefravar_tilfelle\n\n),\n\naktivitetskrav_med_tilfelle_start_dato as (\n  SELECT\n    a.*,\n    b.sykefravar_fra_dato\n  FROM aktivitetskrav a\n  LEFT JOIN sykefravar_tilfeller b  ON b.fk_person1 = a.fk_person1\n  order by a.FK_PERSON1, sykefravar_fra_dato, kafka_mottatt_dato desc\n\n),\n\n/* Null i sykefravar_fra_dato hvis sykefrav\u00e6r 'under behandling'. Aktivitetskravet kan likevel v\u00e6re opprettet.\nM\u00e5 ogs\u00e5 inkludere aktivitetskrav med sykefravar_fra_dato etter aktivitetskravet startet og stoppet.\nDatoverdi settes lik frist p\u00e5 aktivitetskrav etter 56 dager.\n*/\n\naktivitetskrav_uten_sykefravar_treff as (\n  select\n    a.*,\n    case when (sykefravar_fra_dato is null) or (sykefravar_fra_dato > createdat) or (sykefravar_fra_dato > stoppunktat) then to_date(stoppunktat-56) else sykefravar_fra_dato end as tilfelle_startdato\n  from aktivitetskrav_med_tilfelle_start_dato a\n\n),\n\nfinal as (\n  select\n    *\n  from aktivitetskrav_uten_sykefravar_treff\n\n)\n\nselect * from final", "relation_name": "dvh_syfo.mk_aktivitetskrav__join_sykefravar_tilfelle", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.078525Z", "completed_at": "2026-01-22T12:31:02.083858Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.084427Z", "completed_at": "2026-01-22T12:31:02.084434Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.007117271423339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_aktivitetskrav__siste_tilfelle_periode", "compiled": true, "compiled_code": "/* Et sykefrav\u00e6rstilfelle kan ha flere \u00e5rsaker. Spesielt for 'AVVENT'.*/\n/* For \u00e5 f\u00e5 med vurderingar og unntak gjort innenfor en m\u00e5ned, kan vi bruke feltet SISTVURDERT,\nsom vil inneholde datoen for n\u00e5r vurderingen/hendelsen skjedde.\nFor statusene NY, AUTOMATISK_OPPFYLT og NY_VURDERING er ikke SISTVURDERT utfylt, s\u00e5 de m\u00e5 vi plukke ut ved \u00e5 bruke CREATEDAT.\nAUTOMATISK_OPPFYLT som siste status ekskluderes da person ikke vurderes.\nStatus LUKKET ikke h\u00e5ndtert. Havner som null i periode ved telling */\n\n\nWITH aktivitetskrav_last as (\n  SELECT\n    kafka_mottatt_dato,\n    arsaker,\n    arsaker1,\n    arsaker2,\n    createdat,\n    fk_person1,\n    lastet_dato,\n    sysdate as lastet_dato_dbt,\n    case when status in ('NY', 'AUTOMATISK_OPPFYLT', 'NY_VURDERING') and sistvurdert is null then createdat else sistvurdert end as sistvurdert,\n    status,\n    stoppunktat,\n    case when status IN ('NY', 'AUTOMATISK_OPPFYLT', 'NY_VURDERING') then TO_CHAR(createdat, 'YYYYMM') else TO_CHAR(sistvurdert, 'YYYYMM') end as periode,\n    tilfelle_startdato,\n    oppdatert_dato\n  FROM dvh_syfo.mk_aktivitetskrav__join_sykefravar_tilfelle\n/*\n  where (\n    sistvurdert < TO_DATE('2023-09-01','YYYY-MM-DD')\n    and sistvurdert >= TO_DATE('2023-08-01','YYYY-MM-DD')\n    ) or\n    (\n    status in ('NY', 'AUTOMATISK_OPPFYLT', 'NY_VURDERING') and createdat < TO_DATE('2023-09-01','YYYY-MM-DD')\n    and createdat >= TO_DATE('2023-08-01','YYYY-MM-DD')\n    )\n    */\n\n),\n\n\n/* Grupperer sykefrav\u00e6rstilfeller innenfor periode med row-funksjon.\nWHERE indikerer at startdato for sykefrav\u00e6rstilfelle er tidligere enn dato for satt aktivitetskrav.*/\nsiste_tilfelle_i_periode as (\n  select\n    aktivitetskrav_last.*,\n    ROW_NUMBER() over (partition by fk_person1, periode order by tilfelle_startdato desc, kafka_mottatt_dato desc) as rangerte_rader\n  from aktivitetskrav_last\n  where aktivitetskrav_last.tilfelle_startdato < aktivitetskrav_last.createdat and\n   aktivitetskrav_last.tilfelle_startdato < aktivitetskrav_last.stoppunktat\n),\n\n/* Henter siste (latest) status fra sykefrav\u00e6rstilfeller innenfor periode (rangerte_rader = 1). */\nfinal as (\n  select\n    fk_person1,\n    periode,\n    status,\n    oppdatert_dato,\n    arsaker,\n    arsaker1,\n    arsaker2,\n    sistvurdert,\n    stoppunktat,\n    tilfelle_startdato as siste_tilfelle_startdato,\n    lastet_dato,\n    lastet_dato_dbt\n  from siste_tilfelle_i_periode\n  where rangerte_rader=1 and status != 'AUTOMATISK_OPPFYLT'\n)\n\nselect * from final\n\n-- mappe for aktivitetskrav\n-- lage mk_aktivitetskrav__inkr for \u00e5 sette filter\n-- mk_aktivitetskrav__ekstra_kolonner /__andre_flagg / __gyldige_rader / __beriket\n-- mk_aktivitetskrav__surr_key ? Hvor b\u00f8r denne logikken ligge? Det er et view, m\u00e5 den ligge i torg?\n-- bytte ut sistvurdert/createdat med 'hendelse_dato'", "relation_name": "dvh_syfo.mk_aktivitetskrav__siste_tilfelle_periode", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.087181Z", "completed_at": "2026-01-22T12:31:02.090506Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.090946Z", "completed_at": "2026-01-22T12:31:02.090953Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.0048902034759521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_aktivitetskrav__tildelt_enhet_periode", "compiled": true, "compiled_code": "/* Max for \u00e5 hente siste gjeldende dato for n\u00e5r record var gyldig innenfor en periode (m\u00e5ned).\nBrukes for \u00e5 filtrere ut riktig record siden.\nMin for \u00e5 passe p\u00e5 at vi ikke mister aktivitetskrav med periode tidligere enn vi har data p\u00e5\ni person_oversikt_scd.\n*/\n\nWITH aktivitetskrav as (\n  select * from dvh_syfo.mk_aktivitetskrav__siste_tilfelle_periode\n),\n\nperson_oversikt_status_scd as (\n  select\n    fk_person1 as fk_person1_scd,\n    tildelt_enhet,\n    dbt_valid_from,\n    dbt_valid_to,\n    max(dbt_valid_from) over(partition by fk_person1, TO_CHAR(dbt_valid_from, 'YYYYMM') ) as max_dbt_valid_from_periode,\n    TO_CHAR(min(dbt_valid_from) over (partition by fk_person1), 'YYYYMM') as min_periode_scd\n  from dvh_syfo.fk_modia__person_oversikt_status_scd\n  order by dbt_valid_to desc\n),\n\n\naktivitetskrav_med_tildelt_enhet as (\n  select\n    a.*,\n    b.*\n  from aktivitetskrav a\n    left join person_oversikt_status_scd b on a.fk_person1 = b.fk_person1_scd\n),\n\n/* Case l\u00f8ser modellering over flere m\u00e5neder, og s\u00f8rger for at det for en gitt periode hentes riktig tildelt enhet.\n    Uten denne hentes record fra f\u00f8rste m\u00e5ned og siste m\u00e5ned. */\naktivitetskrav_sett_gyldig_enhet_flagg_steg_1 as (\n  select\n    a.*,\n    case\n      when periode <= TO_CHAR(dbt_valid_to, 'YYYYMM')\n        and periode = TO_CHAR(max_dbt_valid_from_periode, 'YYYYMM')\n        and dbt_valid_from = max_dbt_valid_from_periode\n        then 1\n      when periode >= TO_CHAR(max_dbt_valid_from_periode, 'YYYYMM')\n        and (TO_CHAR(dbt_valid_to, 'YYYYMM') is NULL\n          or periode <= TO_CHAR(dbt_valid_to, 'YYYYMM'))\n        and dbt_valid_from = max_dbt_valid_from_periode\n        then 1\n      when tildelt_enhet is null\n        then 1\n      when periode < min_periode_scd\n        and dbt_valid_from = max_dbt_valid_from_periode\n        then row_number() over (partition by fk_person1, periode order by dbt_valid_to nulls first)\n      else 0\n      end as valid_flag\n  from aktivitetskrav_med_tildelt_enhet a\n),\n\naktivitetskrav_sett_gyldig_enhet_flagg_steg_2 as (\n  select\n    a.*,\n    row_number() over (partition by fk_person1, periode order by dbt_valid_to nulls first) as valid_flag_2\n  from aktivitetskrav_sett_gyldig_enhet_flagg_steg_1 a\n  where valid_flag = 1\n),\n\naktivitetskrav_gyldig_enhet as (\n  select *\n  from aktivitetskrav_sett_gyldig_enhet_flagg_steg_2\n  where valid_flag_2 = 1\n),\n\nfinal as (\n  select\n    fk_person1,\n    periode,\n    status,\n    arsaker,\n    arsaker1,\n    arsaker2,\n    sistvurdert,\n    stoppunktat,\n    siste_tilfelle_startdato,\n    tildelt_enhet,\n    oppdatert_dato,\n    lastet_dato,\n    lastet_dato_dbt\n  from aktivitetskrav_gyldig_enhet\n\n)\n\n\nSELECT * FROM final", "relation_name": "dvh_syfo.mk_aktivitetskrav__tildelt_enhet_periode", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.093987Z", "completed_at": "2026-01-22T12:31:02.101296Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.101786Z", "completed_at": "2026-01-22T12:31:02.101800Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009116888046264648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_aktivitetskrav__dimensjoner", "compiled": true, "compiled_code": "with\n\naktivitetskrav as (\n  select * from dvh_syfo.mk_aktivitetskrav__tildelt_enhet_periode\n),\n\ndim_tid as (\n  select * from dvh_syfo.felles_dt_kodeverk__dim_tid\n),\n\ndim_organisasjon as (\n  select * from dvh_syfo.felles_dt_kodeverk__dim_organisasjon\n),\n\ndim_person as (\n  select * from dvh_syfo.felles_dt_person__dim_person1\n),\n\ndim_alder as (\n  select * from dvh_syfo.felles_dt_kodeverk__dim_alder\n),\n\naktivitetskrav_med_dim_tid as (\n  select\n    a.*,\n    b.pk_dim_tid as fk_dim_tid_sf_start_dato,\n    c.pk_dim_tid as fk_dim_tid_passert_8_uker,\n    d.pk_dim_tid as fk_dim_tid_status\n  from aktivitetskrav a\n  left join dim_tid b on b.pk_dim_tid = to_number(to_char(a.siste_tilfelle_startdato, 'YYYYMMDD'))\n  left join dim_tid c on c.pk_dim_tid = to_number(to_char(a.stoppunktat, 'YYYYMMDD'))\n  left join dim_tid d on d.pk_dim_tid = to_number(to_char(a.sistvurdert, 'YYYYMMDD'))\n),\n\naktivitetskrav_med_dim_organisasjon as (\n  select\n    a.*,\n    b.pk_dim_organisasjon as fk_dim_organisasjon\n  from aktivitetskrav_med_dim_tid a\n  left join dim_organisasjon b on b.nav_enhet_kode = a.tildelt_enhet\n    where (b.gyldig_fra_dato <= sistvurdert AND gyldig_til_dato >= sistvurdert and\n          dim_nivaa = 6 and b.gyldig_flagg = 1) or b.pk_dim_organisasjon is null\n),\n\nsykefravar_med_dim_person as (\n  select\n    a.*,\n    b.fk_dim_geografi_bosted,\n    TRUNC(MONTHS_BETWEEN(last_day(to_date(a.periode, 'YYYYMM')), b.fodt_dato)/12) as alder\n  from aktivitetskrav_med_dim_organisasjon a\n  left join dim_person b on b.fk_person1 = a.fk_person1\n   and b.gyldig_flagg = 1\n),\n\nsykefravar_med_dim_alder as (\n  select\n    a.*,\n    b.pk_dim_alder as fk_dim_alder\n  from sykefravar_med_dim_person a\n  left join dim_alder b on b.alder = a.alder\n  where b.gyldig_flagg = 1\n),\n\nfinal as (\n  select\n    fk_person1,\n    periode,\n    arsaker,\n    arsaker1,\n    arsaker2,\n    status,\n    sistvurdert,\n    stoppunktat,\n    oppdatert_dato,\n    siste_tilfelle_startdato,\n    lastet_dato_dbt,\n    fk_dim_tid_sf_start_dato,\n    fk_dim_tid_passert_8_uker,\n    fk_dim_tid_status,\n    fk_dim_organisasjon,\n    fk_dim_geografi_bosted,\n    fk_dim_alder\n  from sykefravar_med_dim_alder\n)\n\n\nSELECT * FROM final", "relation_name": "dvh_syfo.mk_aktivitetskrav__dimensjoner", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.104339Z", "completed_at": "2026-01-22T12:31:02.107809Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.108318Z", "completed_at": "2026-01-22T12:31:02.108331Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.005093812942504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_aktivitetskrav__flagg", "compiled": true, "compiled_code": "WITH arsak_flagg as (\n  select aktivitetskrav.*,\n   CASE\n    WHEN arsaker = 'FRISKMELDT' OR arsaker1= 'FRISKMELDT' OR arsaker2 = 'FRISKMELDT'  THEN 1\n    ELSE 0\n  END AS friskmeldt_flagg,\n  CASE\n    WHEN arsaker = 'GRADERT' OR arsaker1= 'GRADERT' OR arsaker2 = 'GRADERT' THEN 1\n    ELSE 0\n  END AS gradert_flagg,\n  CASE\n    WHEN arsaker = 'TILRETTELEGGING_IKKE_MULIG' OR arsaker1= 'TILRETTELEGGING_IKKE_MULIG' OR arsaker2 = 'TILRETTELEGGING_IKKE_MULIG' THEN 1\n    ELSE 0\n  END AS tilrettelegging_ikke_mulig_flagg,\n  CASE\n    WHEN arsaker = 'SJOMENN_UTENRIKS' OR arsaker1= 'SJOMENN_UTENRIKS' OR arsaker2 = 'SJOMENN_UTENRIKS' THEN 1\n    ELSE 0\n  END AS sjomenn_utenriks_flagg,\n  CASE\n    WHEN arsaker = 'MEDISINSKE_GRUNNER' OR arsaker1= 'MEDISINSKE_GRUNNER' OR arsaker2 = 'MEDISINSKE_GRUNNER' THEN 1\n    ELSE 0\n  END AS medisinske_grunner_flagg,\n  CASE\n    WHEN arsaker = 'ANNET' OR arsaker1= 'ANNET' OR arsaker2 = 'ANNET' THEN 1\n    ELSE 0\n  END AS avvent_annet_flagg,\n  CASE\n    WHEN arsaker = 'INFORMASJON_BEHANDLER' OR arsaker1= 'INFORMASJON_BEHANDLER' OR arsaker2 = 'INFORMASJON_BEHANDLER' THEN 1\n    ELSE 0\n  END AS avvent_informasjon_beh_flagg,\n  CASE\n    WHEN arsaker = 'OPPFOLGINGSPLAN_ARBEIDSGIVER' OR arsaker1= 'OPPFOLGINGSPLAN_ARBEIDSGIVER' OR arsaker2 = 'OPPFOLGINGSPLAN_ARBEIDSGIVER' THEN 1\n    ELSE 0\n  END AS avvent_oppfolgplan_arbgv_flagg,\n  CASE\n    WHEN arsaker NOT IN\n    ('FRISKMELDT', 'GRADERT', 'MEDISINSKE_GRUNNER','SJOMENN_UTENRIKS','TILRETTELEGGING_IKKE_MULIG', 'ANNET', 'INFORMASJON_BEHANDLER', 'OPPFOLGINGSPLAN_ARBEIDSGIVER') THEN 1\n    ELSE 0\n  END AS ukjent_blank_flagg\nFROM dvh_syfo.mk_aktivitetskrav__dimensjoner aktivitetskrav\n\n),\n\naatte_uker_flagg as (\n  select\n      arsak_flagg.*,\n      CASE WHEN TRUNC(sistvurdert, 'DD') - TRUNC(siste_tilfelle_startdato, 'DD') <= 56 AND status = 'UNNTAK' THEN 1 ELSE 0 END as unntak_foer_8_uker_flagg,\n      CASE WHEN TRUNC(sistvurdert, 'DD') - TRUNC(siste_tilfelle_startdato, 'DD') > 56 AND status = 'UNNTAK' THEN 1 ELSE 0 END as unntak_etter_8_uker_flagg\n  from arsak_flagg\n),\n\nfinal as (\n  select * from aatte_uker_flagg\n)\n\nselect * from final", "relation_name": "dvh_syfo.mk_aktivitetskrav__flagg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.110704Z", "completed_at": "2026-01-22T12:31:02.114150Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.114659Z", "completed_at": "2026-01-22T12:31:02.114672Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005056858062744141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.key_gen_syfo_aktivitetskrav_mnd_dbt", "compiled": true, "compiled_code": "\n\nwith aktivitetskrav_beriket as (\n  select * from dvh_syfo.mk_aktivitetskrav__flagg\n),\n\nfak_syfo_aktivitetskrav_mnd_dbt_pk as (\n  select\n    aktivitetskrav_beriket.*,\n    999999 as pk_fak_syfo_aktivitetskrav_mnd\n  from aktivitetskrav_beriket\n)\n\nselect * from fak_syfo_aktivitetskrav_mnd_dbt_pk", "relation_name": "dvh_syfo.key_gen_syfo_aktivitetskrav_mnd_dbt", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.117678Z", "completed_at": "2026-01-22T12:31:02.121385Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.121865Z", "completed_at": "2026-01-22T12:31:02.121874Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.005423307418823242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fak_syfo_aktivitetskrav_mnd_dbt", "compiled": true, "compiled_code": "\n\nwith fak_syfo_aktivitetskrav_mnd AS (\n  select * from dvh_syfo.key_gen_syfo_aktivitetskrav_mnd_dbt\n),\n\nfinal as (\n  select\n    pk_fak_syfo_aktivitetskrav_mnd,\n    fk_person1,\n    fk_dim_tid_sf_start_dato,\n    fk_dim_tid_status,\n    fk_dim_alder,\n    nvl(fk_dim_organisasjon, -1) as fk_dim_organisasjon,\n    nvl(fk_dim_geografi_bosted, -1) as fk_dim_geografi_bosted,\n    to_number(periode) as periode,\n    status,\n    oppdatert_dato,\n    unntak_foer_8_uker_flagg,\n    unntak_etter_8_uker_flagg,\n    medisinske_grunner_flagg,\n    tilrettelegging_ikke_mulig_flagg,\n    sjomenn_utenriks_flagg,\n    fk_dim_tid_passert_8_uker,\n    avvent_annet_flagg,\n    avvent_informasjon_beh_flagg,\n    avvent_oppfolgplan_arbgv_flagg,\n    lastet_dato_dbt\n\n  from fak_syfo_aktivitetskrav_mnd\n)\n\nselect * from final", "relation_name": "dvh_syfo.fak_syfo_aktivitetskrav_mnd_dbt", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.029553Z", "completed_at": "2026-01-22T12:31:02.442254Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.442728Z", "completed_at": "2026-01-22T12:31:02.442742Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.48005127906799316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_dialogmote__union", "compiled": true, "compiled_code": "/********************************************************\n*I denne modellen sl\u00e5s hendelser fra\n*modia kandidatliste (arsak) med hendelser fra modia dialogmote\n*(status_endring_type) sammen til en felles stuktur\n*sl\u00e5r sammen kolonner fra de to systemene med ulikt navn\n*men samme innehold vha decode\n*********************************************************/\nWITH union_all AS (\n  \n\n        (\n            select\n\n                \n                    cast(\"KILDE_UUID\" as VARCHAR2(4000)) as \"KILDE_UUID\" ,\n                    cast(\"HENDELSE_TIDSPUNKT\" as TIMESTAMP(6)) as \"HENDELSE_TIDSPUNKT\" ,\n                    cast(\"FK_PERSON1\" as NUMBER(38,0)) as \"FK_PERSON1\" ,\n                    cast(\"KANDIDAT_FLAGG\" as NUMBER) as \"KANDIDAT_FLAGG\" ,\n                    cast(\"HENDELSE\" as VARCHAR2(4000)) as \"HENDELSE\" ,\n                    cast(\"UNNTAKARSAK\" as VARCHAR2(4000)) as \"UNNTAKARSAK\" ,\n                    cast(\"TILFELLE_STARTDATO\" as DATE) as \"TILFELLE_STARTDATO\" ,\n                    cast(\"NAV_IDENT\" as VARCHAR2(4000)) as \"NAV_IDENT\" ,\n                    cast(\"KAFKA_TOPIC\" as VARCHAR2(255)) as \"KAFKA_TOPIC\" ,\n                    cast(\"KAFKA_PARTISJON\" as NUMBER) as \"KAFKA_PARTISJON\" ,\n                    cast(\"KAFKA_OFFSET\" as NUMBER) as \"KAFKA_OFFSET\" ,\n                    cast(\"KAFKA_MOTTATT_DATO\" as DATE) as \"KAFKA_MOTTATT_DATO\" ,\n                    cast(\"LASTET_DATO\" as DATE) as \"LASTET_DATO\" ,\n                    cast(\"KILDESYSTEM\" as VARCHAR2(50)) as \"KILDESYSTEM\" ,\n                    cast(null as TIMESTAMP(6)) as \"DIALOGMOTE_TIDSPUNKT\" ,\n                    cast(null as VARCHAR2(4000)) as \"VIRKSOMHETSNR\" ,\n                    cast(null as VARCHAR2(4000)) as \"ENHET_NR\" ,\n                    cast(null as NUMBER) as \"ARBEIDSTAKER_FLAGG\" ,\n                    cast(null as NUMBER) as \"ARBEIDSGIVER_FLAGG\" ,\n                    cast(null as NUMBER) as \"SYKMELDER_FLAGG\" \n\n            from dvh_syfo.fk_modia__kandidat_unntak\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n\n                \n                    cast(\"KILDE_UUID\" as VARCHAR2(4000)) as \"KILDE_UUID\" ,\n                    cast(\"HENDELSE_TIDSPUNKT\" as TIMESTAMP(6)) as \"HENDELSE_TIDSPUNKT\" ,\n                    cast(\"FK_PERSON1\" as NUMBER(38,0)) as \"FK_PERSON1\" ,\n                    cast(null as NUMBER) as \"KANDIDAT_FLAGG\" ,\n                    cast(\"HENDELSE\" as VARCHAR2(4000)) as \"HENDELSE\" ,\n                    cast(null as VARCHAR2(4000)) as \"UNNTAKARSAK\" ,\n                    cast(\"TILFELLE_STARTDATO\" as DATE) as \"TILFELLE_STARTDATO\" ,\n                    cast(\"NAV_IDENT\" as VARCHAR2(4000)) as \"NAV_IDENT\" ,\n                    cast(\"KAFKA_TOPIC\" as VARCHAR2(255)) as \"KAFKA_TOPIC\" ,\n                    cast(\"KAFKA_PARTISJON\" as NUMBER) as \"KAFKA_PARTISJON\" ,\n                    cast(\"KAFKA_OFFSET\" as NUMBER) as \"KAFKA_OFFSET\" ,\n                    cast(\"KAFKA_MOTTATT_DATO\" as DATE) as \"KAFKA_MOTTATT_DATO\" ,\n                    cast(\"LASTET_DATO\" as DATE) as \"LASTET_DATO\" ,\n                    cast(\"KILDESYSTEM\" as VARCHAR2(50)) as \"KILDESYSTEM\" ,\n                    cast(\"DIALOGMOTE_TIDSPUNKT\" as TIMESTAMP(6)) as \"DIALOGMOTE_TIDSPUNKT\" ,\n                    cast(\"VIRKSOMHETSNR\" as VARCHAR2(4000)) as \"VIRKSOMHETSNR\" ,\n                    cast(\"ENHET_NR\" as VARCHAR2(4000)) as \"ENHET_NR\" ,\n                    cast(\"ARBEIDSTAKER_FLAGG\" as NUMBER) as \"ARBEIDSTAKER_FLAGG\" ,\n                    cast(\"ARBEIDSGIVER_FLAGG\" as NUMBER) as \"ARBEIDSGIVER_FLAGG\" ,\n                    cast(\"SYKMELDER_FLAGG\" as NUMBER) as \"SYKMELDER_FLAGG\" \n\n            from dvh_syfo.fk_modia__dialogmote_patch\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n\n                \n                    cast(\"KILDE_UUID\" as VARCHAR2(4000)) as \"KILDE_UUID\" ,\n                    cast(\"HENDELSE_TIDSPUNKT\" as TIMESTAMP(6)) as \"HENDELSE_TIDSPUNKT\" ,\n                    cast(\"FK_PERSON1\" as NUMBER(38,0)) as \"FK_PERSON1\" ,\n                    cast(null as NUMBER) as \"KANDIDAT_FLAGG\" ,\n                    cast(\"HENDELSE\" as VARCHAR2(4000)) as \"HENDELSE\" ,\n                    cast(null as VARCHAR2(4000)) as \"UNNTAKARSAK\" ,\n                    cast(\"TILFELLE_STARTDATO\" as DATE) as \"TILFELLE_STARTDATO\" ,\n                    cast(null as VARCHAR2(4000)) as \"NAV_IDENT\" ,\n                    cast(null as VARCHAR2(255)) as \"KAFKA_TOPIC\" ,\n                    cast(null as NUMBER) as \"KAFKA_PARTISJON\" ,\n                    cast(null as NUMBER) as \"KAFKA_OFFSET\" ,\n                    cast(null as DATE) as \"KAFKA_MOTTATT_DATO\" ,\n                    cast(null as DATE) as \"LASTET_DATO\" ,\n                    cast(\"KILDESYSTEM\" as VARCHAR2(50)) as \"KILDESYSTEM\" ,\n                    cast(\"DIALOGMOTE_TIDSPUNKT\" as TIMESTAMP(6)) as \"DIALOGMOTE_TIDSPUNKT\" ,\n                    cast(null as VARCHAR2(4000)) as \"VIRKSOMHETSNR\" ,\n                    cast(\"ENHET_NR\" as VARCHAR2(4000)) as \"ENHET_NR\" ,\n                    cast(null as NUMBER) as \"ARBEIDSTAKER_FLAGG\" ,\n                    cast(null as NUMBER) as \"ARBEIDSGIVER_FLAGG\" ,\n                    cast(null as NUMBER) as \"SYKMELDER_FLAGG\" \n\n            from dvh_syfo.mk_dialogmote__omkode_arena_hendelse\n\n            \n        )\n\n        \n)\n,\nfinal as (\n    SELECT\n      fk_person1,\n      tilfelle_startdato,\n      hendelse,\n      hendelse_tidspunkt,\n      dialogmote_tidspunkt,\n      unntakarsak,\n      enhet_nr,\n      nav_ident,\n      arbeidstaker_flagg,\n      arbeidsgiver_flagg,\n      sykmelder_flagg,\n      kilde_uuid,\n      kildesystem,\n      virksomhetsnr\n    FROM union_all\n)\nselect * from final", "relation_name": "dvh_syfo.mk_dialogmote__union", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.484554Z", "completed_at": "2026-01-22T12:31:02.492282Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.493521Z", "completed_at": "2026-01-22T12:31:02.493542Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.012300968170166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fak_syfo_styringsinformasjon_DM", "compiled": true, "compiled_code": "\n\n\nwith hendelser_org AS (\n    SELECT * FROM dvh_syfo.mk_dialogmote__union\n     where HENDELSE in ('INNKALT','AVLYST','UNNTAK','FERDIGSTILT','STOPPUNKT') and KILDESYSTEM = 'MODIA'\n),\nfinal  as  (\n        select * from\n            (\n                select\n                fk_person1,\n                ENHET_NR,\n                hendelse,\n                tilfelle_startdato,\n                DIALOGMOTE_TIDSPUNKT,\n                hendelse_tidspunkt,\n                unntakarsak\n                from hendelser_org\n                group by\n                fk_person1,\n                ENHET_NR,\n                hendelse,\n                tilfelle_startdato,\n                DIALOGMOTE_TIDSPUNKT,\n                hendelse_tidspunkt,\n                unntakarsak\n             )\n            pivot (\n               count(HENDELSE) as flagg\n            for hendelse\n            in ('STOPPUNKT' KANDIDAT, 'UNNTAK' UNNTAK, 'INNKALT' INNKALT , 'FERDIGSTILT' FERDIGSTILT, 'AVLYST' AVLYST)\n                 )\n\n     )\nSELECt * FROM final", "relation_name": "dvh_syfo.fak_syfo_styringsinformasjon_DM", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.488254Z", "completed_at": "2026-01-22T12:31:02.492887Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.494797Z", "completed_at": "2026-01-22T12:31:02.494812Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012750387191772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_dialogmote__filtrert_hendelse", "compiled": true, "compiled_code": "/************************************************'\n*I denne modellen velges kun hendelser relevante for syfo210\n**************************************************/\nWITH hendelser as (\n  SELECT * FROM dvh_syfo.mk_dialogmote__union\n)\n\n,final as (\n  SELECT\n    *\n  FROM hendelser where hendelse in ('FERDIGSTILT', 'STOPPUNKT','UNNTAK')\n)\n\nSELECT * FROM final", "relation_name": "dvh_syfo.mk_dialogmote__filtrert_hendelse", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.498228Z", "completed_at": "2026-01-22T12:31:02.501187Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.501646Z", "completed_at": "2026-01-22T12:31:02.501657Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.004660367965698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_dialogmote__tidligste_tilfelle_startdato", "compiled": true, "compiled_code": "WITH hendelser AS (\n    SELECT * FROM dvh_syfo.mk_dialogmote__filtrert_hendelse\n)\n\n,final AS (\n  SELECT\n    hendelser.*\n    ,ROW_NUMBER() OVER(PARTITION BY fk_person1, tilfelle_startdato, hendelse ORDER BY dialogmote_tidspunkt, hendelse_tidspunkt) AS row_number\n  FROM hendelser\n)\n\nSELECT * FROM final", "relation_name": "dvh_syfo.mk_dialogmote__tidligste_tilfelle_startdato", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.504335Z", "completed_at": "2026-01-22T12:31:02.507346Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.507753Z", "completed_at": "2026-01-22T12:31:02.507760Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.004442453384399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_dialogmote__pivotert", "compiled": true, "compiled_code": "WITH hendelser as (\n  SELECT aktuelle_hendelser.fk_person1,\n         aktuelle_hendelser.tilfelle_startdato,\n         aktuelle_hendelser.hendelse,\n         aktuelle_hendelser.hendelse_tidspunkt,\n         aktuelle_hendelser.dialogmote_tidspunkt,\n         aktuelle_hendelser.unntakarsak,\n         aktuelle_hendelser.enhet_nr,\n         aktuelle_hendelser.arbeidstaker_flagg,\n         aktuelle_hendelser.arbeidsgiver_flagg,\n         aktuelle_hendelser.sykmelder_flagg,\n         aktuelle_hendelser.kilde_uuid,\n         aktuelle_hendelser.kildesystem,\n         aktuelle_hendelser.virksomhetsnr,\n         aktuelle_hendelser.row_number,\n         aktuelle_hendelser.nav_ident,\n         DECODE(hendelse,'FERDIGSTILT', dialogmote_tidspunkt, hendelse_tidspunkt) AS hendelse_tidspunkt1\n  FROM dvh_syfo.mk_dialogmote__tidligste_tilfelle_startdato aktuelle_hendelser\n),\n\nunntakarsak_modia as (\n  select fk_person1,\n         tilfelle_startdato,\n         hendelse_tidspunkt1,\n         unntakarsak as unntakarsak_modia\n  from hendelser\n  where hendelse='UNNTAK'\n    and kildesystem = 'MODIA'\n)\n\n-- F\u00e5r kun virksomhetsnr fra dialogm\u00f8ter i Modia, s\u00e5 i union-tabellen f\u00e5r virksomhetsnr null-verdier idet flere tabeller sammenstilles.\n-- Joiner denne i neste steg for \u00e5 hindre feil i pivoteringen da vi f\u00e5r flere rader per fk_person1 + tilfelle_startdato (null fra Arena + kandidater og not-null fra dialogm\u00f8ter i Modia).\n,not_null_virksomhetsnr as (\n    select fk_person1, tilfelle_startdato, max(virksomhetsnr) as virksomhetsnr\n    from hendelser\n    group by fk_person1, tilfelle_startdato\n)\n\n/* Finner dialogm\u00f8ter som er avholdt av Regional Oppf\u00f8lgingsenhet (ROE) Vest-Viken.\nNav-identer som jobber for ROE Vest-Viken ligger i tabellen dim_syfo_reg_oppf_enhet_ident.\nDersom en 'FERDIGSTILT'-hendelse er registrert med en av disse identene i tidsrommet identen er gyldig, blir region_oppf_enhet_vviken_flagg satt til 1.\nNB! M\u00e5 bruke min(dialogmote_tidspunkt) for ikkje \u00e5 f\u00e5 med for mange rader. Skal berre hente eitt tidspunkt per tilfelle, */\n, dialogmote_roe as (\n  select h.fk_person1,\n         h.tilfelle_startdato,\n         min(h.hendelse_tidspunkt1) as hendelse_tidspunkt,\n         1 as region_oppf_enhet_vviken_flagg\n  from hendelser h\n  join dim_syfo_reg_oppf_enhet_ident r on r.nav_ident = h.nav_ident\n  where h.hendelse in ('FERDIGSTILT', 'UNNTAK')\n  and trunc(h.hendelse_tidspunkt1) between r.gyldig_fra_dato and r.gyldig_til_dato\n  group by h.fk_person1,\n           h.tilfelle_startdato\n)\n\n,pivotert AS (\n  SELECT * FROM (\n    SELECT\n      a.fk_person1\n      ,a.tilfelle_startdato AS tilfelle_startdato\n      ,CONCAT(a.hendelse, a.ROW_NUMBER) AS hendelse1\n      ,a.hendelse_tidspunkt1\n      ,b.virksomhetsnr\n      ,nvl(c.region_oppf_enhet_vviken_flagg,0) as region_oppf_enhet_vviken_flagg\n    FROM hendelser a\n    left join not_null_virksomhetsnr b on\n      a.fk_person1=b.fk_person1 and a.tilfelle_startdato=b.tilfelle_startdato\n    left join dialogmote_roe c on\n      a.fk_person1=c.fk_person1 and a.tilfelle_startdato=c.tilfelle_startdato\n  )\n  PIVOT(\n    MAX(hendelse_tidspunkt1) FOR hendelse1 IN (\n      'STOPPUNKT1' stoppunkt\n      ,'FERDIGSTILT1' dialogmote_tidspunkt1\n      ,'FERDIGSTILT2' dialogmote_tidspunkt2\n      ,'FERDIGSTILT3' dialogmote_tidspunkt3\n      ,'FERDIGSTILT4' dialogmote_tidspunkt4\n      ,'FERDIGSTILT5' dialogmote_tidspunkt5\n      ,'FERDIGSTILT6' dialogmote_tidspunkt6\n      ,'UNNTAK1' unntak\n    )\n  )\n  ORDER BY\n    fk_person1\n    ,tilfelle_startdato\n),\n\nfinal as (\n    SELECT distinct\n      pivotert.fk_person1,\n      pivotert.tilfelle_startdato,\n      pivotert.virksomhetsnr,\n      pivotert.stoppunkt,\n      pivotert.dialogmote_tidspunkt1,\n      pivotert.dialogmote_tidspunkt2,\n      pivotert.dialogmote_tidspunkt3,\n      pivotert.dialogmote_tidspunkt4,\n      pivotert.dialogmote_tidspunkt5,\n      pivotert.dialogmote_tidspunkt6,\n      pivotert.unntak,\n      um.unntakarsak_modia,\n      pivotert.region_oppf_enhet_vviken_flagg\n    FROM pivotert\n    left join unntakarsak_modia um on um.fk_person1 = pivotert.fk_person1\n                                  and um.tilfelle_startdato = pivotert.tilfelle_startdato\n                                  and um.hendelse_tidspunkt1 = pivotert.unntak\n )\n\nselect * from final", "relation_name": "dvh_syfo.mk_dialogmote__pivotert", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.512700Z", "completed_at": "2026-01-22T12:31:02.522582Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.523109Z", "completed_at": "2026-01-22T12:31:02.523116Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.012995004653930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_dialogmote__naering_ved_tilfelle_startdato", "compiled": true, "compiled_code": "with hendelser as (\n  select * from dvh_syfo.mk_dialogmote__pivotert\n),\n\nvirksomhet as (\n    select * from dvh_syfo.felles_dt_p__dim_virksomhet\n),\n\nnaering as (\n    select * from dvh_syfo.felles_dt_p__dim_naering\n),\n-- Finner riktig bedrift_naring_primar_kode basert p\u00e5 gyldighetsintervall\n-- Kan f\u00e5 ikke-gyldige virksomhetsnr fra Modia. Disse blir null selv om nummer finnes i dim_virksomhet\n-- Setter 'Ukjent'-, '00000'- og null-verdier til '-1' for \u00e5 h\u00e5ndtere join mot dim_naering\n-- '00000' ligger i naeringsstandard 'SN2002', og vil filtreres ut av endelig sett dersom ikke satt til '-1'\n-- 'Ukjent' har mange ikke-unike rader i dim_naering og vil gi for mange treff dersom ikke satt til '-1'\ndialogmoter_join_virksomhet_gyldig_tid as (\n    select\n        hendelser.* ,\n        case\n            when rtrim(bedrift_naring_primar_kode) = 'Ukjent' then '-1'\n            when rtrim(bedrift_naring_primar_kode) = '00000' then '-1'\n            when rtrim(bedrift_naring_primar_kode) is null then '-1'\n            else rtrim(bedrift_naring_primar_kode)\n        end as bedrift_naring_primar_kode\n    from hendelser\n    left join virksomhet on hendelser.virksomhetsnr = virksomhet.bedrift_org_nr\n        and  hendelser.tilfelle_startdato BETWEEN virksomhet.gyldig_fra_dato AND virksomhet.gyldig_til_dato --hendelse_tidspunkt mer ideelt, men har ikke andre tidspunkt fra hendelser \u00e5 joine p\u00e5. Ev. dialogmote2_avholdt_dato?\n),\n\n-- Finner riktig naering_kode basert p\u00e5 gyldighetsintervall\n-- Bruker n\u00e6ringsstandard 'SN2007'. Flere treff per bedrift_naring_primar_kode hvis ikke denne settes\n-- Har med naering_kode is null i where-clause for \u00e5 f\u00e5 med rader som ikke f\u00e5r treff i dim_naering/gyldighetsintervallet\ndialogmoter_join_naering_gyldig_tid as (\n    select\n        dialogmoter_join_virksomhet_gyldig_tid.*,\n        NVL(pk_dim_naering, -1) as fk_dim_naering\n    from dialogmoter_join_virksomhet_gyldig_tid\n    left join naering on naering.naering_kode = dialogmoter_join_virksomhet_gyldig_tid.bedrift_naring_primar_kode\n        and tilfelle_startdato between naering.gyldig_fra_dato and naering.gyldig_til_dato\n    where naeringsstandard='SN2007' or naering_kode is null\n),\n\nfinal as (\n    select * from dialogmoter_join_naering_gyldig_tid\n)\n\nselect * from final", "relation_name": "dvh_syfo.mk_dialogmote__naering_ved_tilfelle_startdato", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.515956Z", "completed_at": "2026-01-22T12:31:02.524134Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.524590Z", "completed_at": "2026-01-22T12:31:02.524596Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.013793230056762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.mk_motebehov__prepp", "compiled": true, "compiled_code": "WITH motebehov AS (\n    SELECT\n        motebehov.*,\n        case when fk_person1_sm = fk_person1_opprettet_av then 1 else 0 end as behov_sykm,\n        case when fk_person1_sm != fk_person1_opprettet_av then 1 else 0 end as behov_arbeidsg\n    FROM dvh_syfo.fk_modia__motebehov motebehov\n    where  motebehov.skjematype in  ('MELD_BEHOV', 'SVAR_BEHOV') and --ikke skjematype lik null (der hvor det allerede er kalt inn)\n           motebehov.har_motebehov = 1--bare de som har meldt at de har behov\n)\n\n,dm AS (\n    SELECT * FROM dvh_syfo.mk_dialogmote__pivotert\n)\n\n,motebehov_tilfelle AS (--knytter motebehov til tilfelle, velger f\u00f8rst alle tilfeller med startdato foer dato for motebehov, finner maks av disse\n    SELECT\n        motebehov.*,\n        MAX(dm.TILFELLE_STARTDATO) OVER(PARTITION BY dm.fk_person1, motebehov_uuid) AS max_tilfelle\n    FROM motebehov\n    LEFT JOIN dm ON\n        fk_person1 = motebehov.fk_person1_sm AND\n        motebehov.opprettet_dato > TILFELLE_STARTDATO\n)\n\n,foerste_behov AS (\n    SELECT\n        MIN(OPPRETTET_DATO) OVER(PARTITION BY fk_person1_sm, max_tilfelle) AS min_opprettet_dato --tidspunkt for det foerste meldte behovet\n        ,MAX(behov_sykm) OVER(PARTITION BY fk_person1_sm, max_tilfelle) as behov_sykmeldt\n        ,MAX(behov_arbeidsg) OVER(PARTITION BY fk_person1_sm, max_tilfelle) as behov_arbeidsgiver\n        ,motebehov_tilfelle.*\n    FROM\n        motebehov_tilfelle\n)\n, final as (\nSELECT DISTINCT\n    fk_person1_sm AS fk_person1\n    , max_tilfelle AS tilfelle_startdato\n    , behov_sykmeldt\n    , behov_arbeidsgiver\n    , min_opprettet_dato AS behov_meldt_dato\nFROM foerste_behov ORDER BY fk_person1_sm, max_tilfelle )\n\nselect * from final", "relation_name": "dvh_syfo.mk_motebehov__prepp", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.530424Z", "completed_at": "2026-01-22T12:31:02.545394Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.546005Z", "completed_at": "2026-01-22T12:31:02.546013Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01863408088684082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fak_dialogmote", "compiled": true, "compiled_code": "\n\n\nWITH hendelser AS (\n  SELECT * FROM dvh_syfo.mk_dialogmote__pivotert\n  \n  -- Filtrerer p\u00e5 tilfeller hvor det har v\u00e6rt aktivitet siste 7 dager\n  -- Dette inkluderer nye dialogm\u00f8ter, unntakstidspunkt eller andre oppdateringer\n  WHERE GREATEST(\n    NVL(dialogmote_tidspunkt1, TO_DATE('1900-01-01', 'YYYY-MM-DD')),\n    NVL(dialogmote_tidspunkt2, TO_DATE('1900-01-01', 'YYYY-MM-DD')),\n    NVL(dialogmote_tidspunkt3, TO_DATE('1900-01-01', 'YYYY-MM-DD')),\n    NVL(dialogmote_tidspunkt4, TO_DATE('1900-01-01', 'YYYY-MM-DD')),\n    NVL(dialogmote_tidspunkt5, TO_DATE('1900-01-01', 'YYYY-MM-DD')),\n    NVL(dialogmote_tidspunkt6, TO_DATE('1900-01-01', 'YYYY-MM-DD')),\n    NVL(unntak, TO_DATE('1900-01-01', 'YYYY-MM-DD')),\n    NVL(stoppunkt, TO_DATE('1900-01-01', 'YYYY-MM-DD'))\n  ) >= CURRENT_DATE - 7\n  \n)\n\n,dim_person1 AS (\n  SELECT * FROM dvh_syfo.felles_dt_person__dim_person1\n)\n\n,dim_organisasjon AS (\n  SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_organisasjon\n)\n\n,dim_org AS (\n  SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_org\n)\n\n,motebehov AS (\n  SELECT * FROM dvh_syfo.mk_motebehov__prepp\n)\n\n,dim_alder as (\n  select * from dvh_syfo.felles_dt_kodeverk__dim_alder\n)\n\n,hendelser_med_naering as (\n  select * from dvh_syfo.mk_dialogmote__naering_ved_tilfelle_startdato\n)\n\n,dm_2 as (\n/*\nSetter dialogmote2_avholdt_dato basert p\u00e5 reglene:\n1. Hvis dialogmote_tidspunkt1 = NULL,                             => NULL\n2. Hvis dialogmote_tidspunkt1 > unntak,                           => NULL (det er bare \u00e5 f\u00e5 unntak kun for dialogm\u00f8te 2)\n3. Hvis (dialogmote_tidspunkt1 - tilfelle_startdato) > 365 dager, => NULL\n4. Hvis unntak = NULL,                                            => dialogmote_tidspunkt1\n5. Hvis dialogmote_tidspunkt1 < unntak,                           => dialogmote_tidspunkt1\n*/\n  select fk_person1,\n         tilfelle_startdato,\n         dialogmote_tidspunkt1,\n         dialogmote_tidspunkt2,\n         dialogmote_tidspunkt3,\n         dialogmote_tidspunkt4,\n         dialogmote_tidspunkt5,\n         dialogmote_tidspunkt6,\n    CASE\n      WHEN (dialogmote_tidspunkt1 is null) or (dialogmote_tidspunkt1 > unntak)\n                                           or (extract(day from (dialogmote_tidspunkt1 - tilfelle_startdato))) > 365 then null\n      WHEN unntak is null then dialogmote_tidspunkt1\n      WHEN dialogmote_tidspunkt1 < unntak then dialogmote_tidspunkt1\n    END AS dialogmote2_avholdt_dato\n  from dvh_syfo.mk_dialogmote__pivotert\n  ),\n\ndm_3 as (\n/*\nSetter dialogmoteX_avholdt_dato basert p\u00e5 reglene:\n1. Hvis dialogmote2_avholdt_dato = NULL (unntak) og tidspunkt for dialogm\u00f8tehendelse er under 365 dager siden sykefrav\u00e6rtilfelle => dialogmote_tidspunkt_(X-1)\n2. Hvis dialogmote2_avholdt_dato != NULL (ikke unntak) og tidspunkt for dialogm\u00f8tehendelse er under 365 dager siden sykefrav\u00e6rtilfelle => dialogmote_tidspunkt_X\n2. Ellers NULL\n*/\n  select dm_2.*,\n    CASE\n      WHEN dialogmote2_avholdt_dato is null and extract(day from (dialogmote_tidspunkt1 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt1\n      WHEN dialogmote2_avholdt_dato is not null and extract(day from (dialogmote_tidspunkt2 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt2\n      else null\n    END AS dialogmote3_avholdt_dato\n  from dm_2\n  ),\n\ndm_4 as (\n\n  select dm_3.*,\n    CASE\n      WHEN dialogmote2_avholdt_dato is null and extract(day from (dialogmote_tidspunkt2 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt2\n      WHEN dialogmote2_avholdt_dato is not null and extract(day from (dialogmote_tidspunkt3 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt3\n      else null\n    END AS dialogmote4_avholdt_dato\n  from dm_3\n  ),\n\ndm_5 as (\n\n  select dm_4.*,\n    CASE\n      WHEN dialogmote2_avholdt_dato is null and extract(day from (dialogmote_tidspunkt3 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt3\n      WHEN dialogmote2_avholdt_dato is not null and extract(day from (dialogmote_tidspunkt4 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt4\n      else null\n    END AS dialogmote5_avholdt_dato\n  from dm_4\n  ),\n\ndm_6 as (\n\n  select dm_5.*,\n    CASE\n      WHEN dialogmote2_avholdt_dato is null and extract(day from (dialogmote_tidspunkt4 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt4\n      WHEN dialogmote2_avholdt_dato is not null and extract(day from (dialogmote_tidspunkt5 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt5\n      else null\n    END AS dialogmote6_avholdt_dato\n  from dm_5\n  ),\n\ndm_7 as (\n\n  select dm_6.*,\n    CASE\n      WHEN dialogmote2_avholdt_dato is null and extract(day from (dialogmote_tidspunkt5 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt5\n      WHEN dialogmote2_avholdt_dato is not null and extract(day from (dialogmote_tidspunkt6 - tilfelle_startdato)) <= 365 then dialogmote_tidspunkt6\n      else null\n    END AS dialogmote7_avholdt_dato\n  from dm_6\n  ),\n\ndm_2_7 as (\n/*\nSamler alle dialogmote_avholdt_dato fra dm_2 til dm_7\n*/\n  select fk_person1,\n         tilfelle_startdato,\n         dialogmote2_avholdt_dato,\n         dialogmote3_avholdt_dato,\n         dialogmote4_avholdt_dato,\n         dialogmote5_avholdt_dato,\n         dialogmote6_avholdt_dato,\n         dialogmote7_avholdt_dato\n  from dm_7\n)\n-- Trengs dm3-7 i SELECT her?\n,flagg_innen_26Uker AS (\n  SELECT fk_person1,\n         tilfelle_startdato,\n         dialogmote2_avholdt_dato,\n         dialogmote3_avholdt_dato,\n         dialogmote4_avholdt_dato,\n         dialogmote5_avholdt_dato,\n         dialogmote6_avholdt_dato,\n         dialogmote7_avholdt_dato,\n    CASE\n      WHEN dialogmote2_avholdt_dato IS NULL THEN NULL\n      WHEN dialogmote2_avholdt_dato < (tilfelle_startdato + 26*7) THEN 1\n      ELSE 0\n    END AS dialogmote2_innen_26_uker_flagg\n  FROM dm_2_7\n)\n\n\n\n,joined AS (\n  SELECT\n    hendelser.fk_person1\n    ,hendelser.tilfelle_startdato\n    ,hendelser.virksomhetsnr\n    ,dialogmote2_innen_26_uker_flagg AS dm2_innen_26_uker_flagg\n    ,behov_meldt_dato\n    ,behov_sykmeldt\n    ,behov_arbeidsgiver\n    ,dialogmote2_avholdt_dato\n    ,dialogmote3_avholdt_dato\n    ,dialogmote4_avholdt_dato\n    ,dialogmote5_avholdt_dato\n    ,dialogmote6_avholdt_dato\n    ,dialogmote7_avholdt_dato\n    ,hendelser.unntak AS unntak_dato\n    ,hendelser.unntakarsak_modia\n    ,TRUNC(hendelser.tilfelle_startdato + 26*7, 'MM') AS tilfelle_26uker_mnd_startdato\n    ,dim_person1.fk_dim_organisasjon\n    ,NVL(TO_NUMBER(\n      TO_CHAR(motebehov.behov_meldt_dato, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__behov_meldt\n    ,NVL(TO_NUMBER(\n      TO_CHAR(hendelser.tilfelle_startdato, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__tilfelle_startdato\n    ,NVL(TO_NUMBER(\n      TO_CHAR(dialogmote2_avholdt_dato, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__dm2_avholdt_dato\n    ,NVL(TO_NUMBER(\n      TO_CHAR(dialogmote3_avholdt_dato, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__dm3_avholdt_dato\n    ,NVL(TO_NUMBER(\n      TO_CHAR(dialogmote4_avholdt_dato, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__dm4_avholdt_dato\n    ,NVL(TO_NUMBER(\n      TO_CHAR(dialogmote5_avholdt_dato, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__dm5_avholdt_dato\n    ,NVL(TO_NUMBER(\n      TO_CHAR(dialogmote6_avholdt_dato, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__dm6_avholdt_dato\n    ,NVL(TO_NUMBER(\n      TO_CHAR(dialogmote7_avholdt_dato, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__dm7_avholdt_dato\n    ,NVL(TO_NUMBER(\n      TO_CHAR(hendelser.unntak, 'YYYYMMDD')\n    ), -1) AS fk_dim_tid__unntak_dato\n    , NVL(dim_alder.pk_dim_alder, -1) as fk_dim_alder\n    , NVL(dim_person1.fk_dim_kjonn, -1) as fk_dim_kjonn\n    , fk_dim_naering\n    , hendelser.region_oppf_enhet_vviken_flagg as region_oppf_enhet_vviken_flagg\n  FROM hendelser\n  LEFT JOIN dim_person1 ON\n    hendelser.fk_person1 = dim_person1.fk_person1 AND\n    hendelser.tilfelle_startdato BETWEEN dim_person1.gyldig_fra_dato AND dim_person1.gyldig_til_dato\n    -- Brukers virksomhetsnr, kj\u00f8nn og organisasjon v/tilfelle_startdato\n  LEFT JOIN flagg_innen_26Uker ON\n    hendelser.fk_person1 = flagg_innen_26Uker.fk_person1 AND\n    hendelser.tilfelle_startdato = flagg_innen_26Uker.tilfelle_startdato\n  LEFT JOIN dim_organisasjon ON\n    dim_person1.fk_dim_organisasjon = dim_organisasjon.pk_dim_organisasjon\n  LEFT JOIN dim_org ON\n    dim_organisasjon.mapping_node_kode = dim_org.mapping_node_kode AND\n    dim_org.funk_gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD') AND -- TODO: B\u00f8r settes p\u00e5 en annen m\u00e5te\n    dim_org.mapping_node_type = 'NORGENHET'\n  LEFT JOIN motebehov ON\n    hendelser.fk_person1 = motebehov.fk_person1 AND\n    hendelser.tilfelle_startdato = motebehov.tilfelle_startdato\n  LEFT JOIN dim_alder ON\n   -- dim_alder.alder = TRUNC(MONTHS_BETWEEN(hendelser.tilfelle_startdato, dim_person1.fodt_dato)/12) -- Brukt til m\u00e5nedlig rapportering - feil?\n    dim_alder.alder = floor((hendelser.tilfelle_startdato-dim_person1.fodt_dato)/365.25)\n    and hendelser.tilfelle_startdato between dim_person1.gyldig_fra_dato AND dim_person1.gyldig_til_dato\n  LEFT JOIN hendelser_med_naering ON\n    hendelser.fk_person1 = hendelser_med_naering.fk_person1\n    and hendelser.tilfelle_startdato = hendelser_med_naering.tilfelle_startdato\n\n  )\n\n,final as (\n  select\n    fk_person1,\n    tilfelle_startdato,\n    virksomhetsnr,\n    dm2_innen_26_uker_flagg,\n    behov_meldt_dato,\n    behov_sykmeldt,\n    behov_arbeidsgiver,\n    dialogmote2_avholdt_dato,\n    dialogmote3_avholdt_dato,\n    dialogmote4_avholdt_dato,\n    dialogmote5_avholdt_dato,\n    dialogmote6_avholdt_dato,\n    dialogmote7_avholdt_dato,\n    unntak_dato,\n    unntakarsak_modia,\n    tilfelle_26uker_mnd_startdato,\n    fk_dim_organisasjon,\n    fk_dim_tid__behov_meldt,\n    fk_dim_tid__tilfelle_startdato,\n    fk_dim_tid__dm2_avholdt_dato,\n    fk_dim_tid__dm3_avholdt_dato,\n    fk_dim_tid__dm4_avholdt_dato,\n    fk_dim_tid__dm5_avholdt_dato,\n    fk_dim_tid__dm6_avholdt_dato,\n    fk_dim_tid__dm7_avholdt_dato,\n    fk_dim_tid__unntak_dato,\n    fk_dim_alder,\n    fk_dim_kjonn,\n    fk_dim_naering,\n    region_oppf_enhet_vviken_flagg\n  from joined\n)\n\nSELECT * FROM final", "relation_name": "dvh_syfo.fak_dialogmote", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.539755Z", "completed_at": "2026-01-22T12:31:02.546792Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.547770Z", "completed_at": "2026-01-22T12:31:02.547781Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.019327402114868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.fak_dialogmote_dverk", "compiled": true, "compiled_code": "\n\n\nWITH hendelser AS (\n  SELECT * FROM dvh_syfo.mk_dialogmote__pivotert\n)\n\n,dim_person1 AS (\n  SELECT * FROM dvh_syfo.felles_dt_person__dim_person1\n)\n\n,dim_organisasjon AS (\n  SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_organisasjon\n)\n\n,dim_org AS (\n  SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_org\n)\n\n,motebehov AS (\n  SELECT * FROM dvh_syfo.mk_motebehov__prepp\n)\n, dm_2_3 as (\n  select fk_person1, tilfelle_startdato,\n    CASE\n      WHEN unntak is null then dialogmote_tidspunkt1\n      WHEN dialogmote_tidspunkt1 < unntak then dialogmote_tidspunkt1\n      WHEN dialogmote_tidspunkt1 > unntak then null\n    END AS dialogmote2_avholdt_dato\n    --,dialogmote_tidspunkt2 AS dialogmote3_avholdt_dato\n    ,CASE\n      WHEN unntak is null then dialogmote_tidspunkt2\n      WHEN dialogmote_tidspunkt1 < unntak then dialogmote_tidspunkt2\n      WHEN dialogmote_tidspunkt1 > unntak then dialogmote_tidspunkt1\n    END AS dialogmote3_avholdt_dato\n  from hendelser\n)\n,flag_innen_26Uker AS (\n  SELECT fk_person1, tilfelle_startdato, dialogmote2_avholdt_dato, dialogmote3_avholdt_dato,\n    CASE\n      WHEN dialogmote2_avholdt_dato IS NULL THEN NULL\n      WHEN dialogmote2_avholdt_dato < (tilfelle_startdato + 26*7) THEN 1\n      ELSE 0\n    END AS dialogmote2_innen_26_uker_flagg\n  FROM dm_2_3\n)\n,final AS (\n  SELECT\n    hendelser.fk_person1\n    ,hendelser.tilfelle_startdato\n    ,dialogmote2_innen_26_uker_flagg AS dm2_innen_26_uker_flagg\n    ,behov_meldt_dato\n    ,behov_sykmeldt\n    ,behov_arbeidsgiver\n    ,dialogmote2_avholdt_dato\n    ,dialogmote3_avholdt_dato\n    ,unntak AS unntak_dato\n    ,TRUNC(hendelser.tilfelle_startdato + 26*7, 'MM') AS tilfelle_26uker_mnd_startdato\n    ,dim_org.ek_dim_org\n    ,dim_person1.fk_dim_organisasjon\n    ,TO_NUMBER(\n      TO_CHAR(motebehov.behov_meldt_dato, 'YYYYMMDD')\n    ) AS fk_dim_tid__behov_meldt\n    ,TO_NUMBER(\n      TO_CHAR(hendelser.tilfelle_startdato, 'YYYYMMDD')\n    ) AS fk_dim_tid__tilfelle_startdato\n    ,TO_NUMBER(\n      TO_CHAR(dialogmote2_avholdt_dato, 'YYYYMMDD')\n    ) AS fk_dim_tid__dm2_avholdt_dato\n    ,TO_NUMBER(\n      TO_CHAR(dialogmote3_avholdt_dato, 'YYYYMMDD')\n    ) AS fk_dim_tid__dm3_avholdt_dato\n    ,TO_NUMBER(\n      TO_CHAR(unntak, 'YYYYMMDD')\n    ) AS fk_dim_tid__unntak_dato\n  FROM hendelser\n  LEFT JOIN dim_person1 ON\n    hendelser.fk_person1 = dim_person1.fk_person1 AND\n    hendelser.tilfelle_startdato BETWEEN dim_person1.gyldig_fra_dato AND dim_person1.gyldig_til_dato\n  LEFT JOIN flag_innen_26Uker ON\n    hendelser.fk_person1 = flag_innen_26Uker.fk_person1 AND\n    hendelser.tilfelle_startdato = flag_innen_26Uker.tilfelle_startdato\n  LEFT JOIN dim_organisasjon ON\n    dim_person1.fk_dim_organisasjon = dim_organisasjon.pk_dim_organisasjon\n  LEFT JOIN dim_org ON\n    dim_organisasjon.mapping_node_kode = dim_org.mapping_node_kode AND\n    dim_org.funk_gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD') AND -- TODO: B\u00f8r settes p\u00e5 en annen m\u00e5te\n    dim_org.mapping_node_type = 'NORGENHET'\n  LEFT JOIN motebehov ON\n    hendelser.fk_person1 = motebehov.fk_person1 AND\n    hendelser.tilfelle_startdato = motebehov.tilfelle_startdato\n)\n\nSELECT * FROM final", "relation_name": "dvh_syfo.fak_dialogmote_dverk", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.566057Z", "completed_at": "2026-01-22T12:31:02.569366Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.573760Z", "completed_at": "2026-01-22T12:31:02.573785Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.022105932235717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dmx_poc.fak_dialogmote__snapshot", "compiled": true, "compiled_code": "\n\n\n\nSELECT\n  TO_CHAR(fk_person1) || '-' || TO_CHAR(tilfelle_startdato)  AS id\n  ,dialogmote.*\nFROM\n  dvh_syfo.fak_dialogmote dialogmote\n", "relation_name": "dvh_syfo.fak_dialogmote__snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.555497Z", "completed_at": "2026-01-22T12:31:02.572816Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.575425Z", "completed_at": "2026-01-22T12:31:02.575436Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.025409460067749023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_fak_dialogmote", "compiled": true, "compiled_code": "\n\nwITH gen_dato AS (\n    SELECT trunc(CAST(DATE '2019-01-01' + LEVEL - 1 AS TIMESTAMP)) AS dato\n    FROM dual\n    CONNECT BY LEVEL <= (DATE '2024-12-31' - DATE '2019-01-01' + 1)\n),\nfakta_gen AS (\n    SELECT * FROM dvh_syfo.fak_dialogmote\n),\ndim_org AS (\n    select * from dvh_syfo.felles_dt_kodeverk__dim_organisasjon\n),\n\ndim_alder AS (\n    SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_alder\n),\ndim_geografi as (\n    SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_geografi\n),\ndim_person1 AS (\n  SELECT * FROM dvh_syfo.felles_dt_person__dim_person1\n),\n\ndialogm\u00f8ter_agg AS (\n    SELECT\n        EXTRACT(YEAR FROM gen_dato.dato) AS aar,\n        EXTRACT(MONTH FROM gen_dato.dato) AS maaned,\n        TO_CHAR(gen_dato.dato, 'IW') as uke,\n        dim_org.nav_enhet_navn,\n        dim_org.nav_nivaa3_navn as enhet_fylke,\n        dim_geografi.fylke_navn as bosted_fylke,\n        dim_geografi.kommune_navn as bosted_kommune,\n        dim_alder.alder as alder,\n        CASE\n            WHEN dim_person1.fk_dim_kjonn = 5002 THEN 'K'\n            WHEN dim_person1.fk_dim_kjonn = 5001 THEN 'M'\n            ELSE 'U'\n        END as kjonn,\n        CASE\n            WHEN dialogmote2_avholdt_dato IS NULL THEN -2\n            WHEN dialogmote2_avholdt_dato < (tilfelle_startdato + 26*7) THEN 1\n            ELSE 0\n        END AS dialogmote2_innen_26_uker_flagg,\n        -2 as dialogmote3_innen_39_uker_flagg,\n        CASE\n            WHEN unntak_dato IS NULL THEN -2\n            WHEN unntak_dato < (tilfelle_startdato + 26*7) THEN 1\n            ELSE 0\n        END AS unntak_innen_26_uker_flagg,\n        COUNT(fakta_gen.DIALOGMOTE2_AVHOLDT_DATO) AS antall_dialogm\u00f8ter2,\n        0 as antall_dialogm\u00f8ter3,\n        0 as antall_tilfelle_startdato\n    FROM\n        gen_dato\n    LEFT JOIN\n        fakta_gen  ON TO_CHAR(gen_dato.dato,'YYYYMMDD') = TO_CHAR(fakta_gen.DIALOGMOTE2_AVHOLDT_DATO, 'YYYYMMDD')\n    JOIN\n        dim_org  ON fakta_gen.fk_dim_organisasjon = dim_org.pk_dim_organisasjon\n    join\n        dim_alder  ON fakta_gen.fk_dim_alder = dim_alder.pk_dim_alder\n    join\n        dim_person1  ON fakta_gen.fk_person1 = dim_person1.fk_person1\n       and dim_person1.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n    JOIN\n        dim_geografi ON dim_person1.fk_dim_geografi_bosted = dim_geografi.pk_dim_geografi\n        and dim_person1.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n        and  dim_geografi.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n    GROUP BY\n        EXTRACT(YEAR FROM gen_dato.dato),\n        EXTRACT(MONTH FROM gen_dato.dato),\n        TO_CHAR(gen_dato.dato, 'IW'),\n        dim_org.nav_enhet_navn,\n        dim_org.nav_nivaa3_navn,\n        dim_geografi.fylke_navn,\n        dim_geografi.kommune_navn,\n        dim_alder.alder,\n        CASE\n            WHEN dim_person1.fk_dim_kjonn = 5002 THEN 'K'\n            WHEN dim_person1.fk_dim_kjonn = 5001 THEN 'M'\n            ELSE 'U'\n        END,\n         CASE\n            WHEN dialogmote2_avholdt_dato IS NULL THEN -2\n            WHEN dialogmote2_avholdt_dato < (tilfelle_startdato + 26*7) THEN 1\n            ELSE 0\n        END,\n        CASE\n            WHEN unntak_dato IS NULL THEN -2\n            WHEN unntak_dato < (tilfelle_startdato + 26*7) THEN 1\n            ELSE 0\n        END\n    -- antall dialogm\u00f8ter 3\n    union all\n    SELECT\n        EXTRACT(YEAR FROM gen_dato.dato) AS aar,\n        EXTRACT(MONTH FROM gen_dato.dato) AS maaned,\n        TO_CHAR(gen_dato.dato, 'IW') as uke,\n        dim_org.nav_enhet_navn,\n        dim_org.nav_nivaa3_navn as enhet_fylke,\n        dim_geografi.fylke_navn as bosted_fylke,\n        dim_geografi.kommune_navn as bosted_kommune,\n        dim_alder.alder as alder,\n        CASE\n            WHEN dim_person1.fk_dim_kjonn = 5002 THEN 'K'\n            WHEN dim_person1.fk_dim_kjonn = 5001 THEN 'M'\n            ELSE 'U'\n        END as kjonn,\n        -2 as dialogmote2_innen_26_uker_flagg,\n         CASE\n            WHEN dialogmote3_avholdt_dato IS NULL THEN -2\n            WHEN dialogmote3_avholdt_dato < (tilfelle_startdato + 39*7) THEN 1\n            ELSE 0\n            END AS dialogmote3_innen_39_uker_flagg,\n        -2 as unntak_innen_26_uker_flagg,\n        0 as antall_dialogm\u00f8ter2,\n        COUNT(fakta_gen.DIALOGMOTE3_AVHOLDT_DATO) AS antall_dialogm\u00f8ter3,\n        0 as antall_tilfelle_startdato\n    FROM\n        gen_dato\n    LEFT JOIN\n        fakta_gen  ON TO_CHAR(gen_dato.dato,'YYYYMMDD') = TO_CHAR(fakta_gen.DIALOGMOTE3_AVHOLDT_DATO, 'YYYYMMDD')\n    JOIN\n        dim_org  ON fakta_gen.fk_dim_organisasjon = dim_org.pk_dim_organisasjon\n    join\n        dim_alder  ON fakta_gen.fk_dim_alder = dim_alder.pk_dim_alder\n    join\n        dim_person1  ON fakta_gen.fk_person1 = dim_person1.fk_person1\n        and  dim_person1.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n    JOIN\n        dim_geografi ON dim_person1.fk_dim_geografi_bosted = dim_geografi.pk_dim_geografi\n        and  dim_person1.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n        and  dim_geografi.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n    GROUP BY\n        EXTRACT(YEAR FROM gen_dato.dato),\n        EXTRACT(MONTH FROM gen_dato.dato),\n        TO_CHAR(gen_dato.dato, 'IW'),\n        dim_org.nav_enhet_navn,\n        dim_org.nav_nivaa3_navn,\n        dim_geografi.fylke_navn,\n        dim_geografi.kommune_navn,\n        dim_alder.alder,\n        CASE\n            WHEN dim_person1.fk_dim_kjonn = 5002 THEN 'K'\n            WHEN dim_person1.fk_dim_kjonn = 5001 THEN 'M'\n            ELSE 'U'\n        END,\n        -2, -- dialogmote2_innen_26_uker_flagg\n        CASE\n            WHEN dialogmote3_avholdt_dato IS NULL THEN -2\n            WHEN dialogmote3_avholdt_dato < (tilfelle_startdato + 39*7) THEN 1\n            ELSE 0\n        END,\n        -2 --unntak_innen_26_uker_flagg\n    -- antall tilfeller\n    union all\n    SELECT\n        EXTRACT(YEAR FROM gen_dato.dato) AS aar,\n        EXTRACT(MONTH FROM gen_dato.dato) AS maaned,\n        TO_CHAR(gen_dato.dato, 'IW') as uke,\n        dim_org.nav_enhet_navn,\n        dim_org.nav_nivaa3_navn as enhet_fylke,\n        dim_geografi.fylke_navn as bosted_fylke,\n        dim_geografi.kommune_navn as bosted_kommune,\n        dim_alder.alder as alder,\n        CASE\n            WHEN dim_person1.fk_dim_kjonn = 5002 THEN 'K'\n            WHEN dim_person1.fk_dim_kjonn = 5001 THEN 'M'\n            ELSE 'U'\n        END as kjonn,\n        -2 as dialogmote2_innen_26_uker_flagg,\n        -2 as dialogmote3_innen_39_uker_flagg,\n        -2 as unntak_innen_26_uker_flagg,\n        0 as antall_dialogm\u00f8ter2,\n        0 as antall_dialogm\u00f8ter3,\n        COUNT(fakta_gen.tilfelle_startdato) AS antall_tilfelle_startdato\n    FROM\n        gen_dato\n    LEFT JOIN\n        fakta_gen  ON TO_CHAR(gen_dato.dato,'YYYYMMDD') = TO_CHAR(fakta_gen.tilfelle_startdato, 'YYYYMMDD')\n    JOIN\n        dim_org  ON fakta_gen.fk_dim_organisasjon = dim_org.pk_dim_organisasjon\n    join\n        dim_alder  ON fakta_gen.fk_dim_alder = dim_alder.pk_dim_alder\n    join\n        dim_person1  ON fakta_gen.fk_person1 = dim_person1.fk_person1\n        and  dim_person1.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n    JOIN\n        dim_geografi ON dim_person1.fk_dim_geografi_bosted = dim_geografi.pk_dim_geografi\n        and  dim_person1.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n        and  dim_geografi.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n    GROUP BY\n        EXTRACT(YEAR FROM gen_dato.dato),\n        EXTRACT(MONTH FROM gen_dato.dato),\n        TO_CHAR(gen_dato.dato, 'IW'),\n        dim_org.nav_enhet_navn,\n        dim_org.nav_nivaa3_navn,\n        dim_geografi.fylke_navn,\n        dim_geografi.kommune_navn,\n        dim_alder.alder,\n        CASE\n            WHEN dim_person1.fk_dim_kjonn = 5002 THEN 'K'\n            WHEN dim_person1.fk_dim_kjonn = 5001 THEN 'M'\n            ELSE 'U'\n        END,\n        -2, -- dialogmote2_innen_26_uker_flagg\n        -2, -- dialogmote3_innen_39_uker_flagg\n        -2 -- unntak_innen_26_uker_flagg\n)\nSELECT * FROM dialogm\u00f8ter_agg", "relation_name": "dvh_syfo.agg_fak_dialogmote", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.561422Z", "completed_at": "2026-01-22T12:31:02.574696Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.576980Z", "completed_at": "2026-01-22T12:31:02.576988Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.025839567184448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dmx_poc.agg_fak_dialogmote_sub", "compiled": true, "compiled_code": "\n\nwITH gen_dato AS (\n    SELECT CAST((DATE '2023-01-01' + LEVEL - 1) AS TIMESTAMP) AS dato\n    FROM dual\n    CONNECT BY LEVEL <= (TRUNC(SYSDATE) - DATE '2023-01-01' + 1)\n),\nfakta_gen_org AS (\n    SELECT dialogmote2_avholdt_dato,DIALOGMOTE3_AVHOLDT_DATO,unntak_dato,behov_meldt_dato,\n    TILFELLE_STARTDATO,fk_dim_organisasjon,fk_dim_alder,fk_person1,fk_dim_naering\n    FROM dvh_syfo.fak_dialogmote\n),\nfakta_gen AS (\n    select fakta_gen_org.*,\n    CASE\n        WHEN dialogmote2_avholdt_dato IS NULL THEN NULL\n        WHEN (trunc(cast(DIALOGMOTE2_AVHOLDT_DATO as date),'d') -\n            trunc(cast(TILFELLE_STARTDATO as date),'d')) <= 26*7\n        THEN DIALOGMOTE2_AVHOLDT_DATO\n        ELSE NULL\n    END AS dialogmote2_innen_26_uker_dato,\n    CASE\n        WHEN dialogmote3_avholdt_dato IS NULL THEN NULL\n        WHEN (trunc(cast(DIALOGMOTE3_AVHOLDT_DATO as date),'d') -\n            trunc(cast(TILFELLE_STARTDATO as date),'d')) <= 39*7\n        THEN DIALOGMOTE3_AVHOLDT_DATO\n        ELSE NULL\n    END AS dialogmote3_innen_39_uker_dato,\n    CASE\n        WHEN unntak_dato IS NULL THEN NULL\n        WHEN (trunc(cast(unntak_dato as date),'d') -\n            trunc(cast(TILFELLE_STARTDATO as date),'d')) <=26*7\n        THEN unntak_dato\n        ELSE NULL\n    END AS unntak_innen_26_uker_dato,\n    CASE\n        WHEN behov_meldt_dato IS NULL THEN NULL\n        WHEN (trunc(cast(behov_meldt_dato as date),'d') -\n            trunc(cast(TILFELLE_STARTDATO as date),'d')) < 26*7\n        THEN behov_meldt_dato\n        ELSE NULL\n    END AS behov_meldt_innen_26_uker_dato\n\n    from fakta_gen_org\n),\ndim_org AS (\n    SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_organisasjon\n),\ndim_geografi as (\n    SELECT * FROM dvh_syfo.felles_dt_kodeverk__dim_geografi\n),\ndim_alder AS (\n    SELECT *\n    FROM dvh_syfo.felles_dt_kodeverk__dim_alder\n),\ndim_person1 AS (\n  SELECT * FROM dvh_syfo.felles_dt_person__dim_person1\n),\nnaering as (\n    select * from dvh_syfo.felles_dt_p__dim_naering\n),\n\ndialogm\u00f8ter_agg AS (\nSELECT\n    EXTRACT(YEAR FROM gen_dato.dato) AS aar,\n    EXTRACT(MONTH FROM gen_dato.dato) AS maaned,\n    TO_CHAR(gen_dato.dato, 'IW') as uke,\n    dim_org.nav_nivaa2_navn as enhet_fylke,\n    dim_org.nav_enhet_navn,\n    dim_geografi.fylke_navn as bosted_fylke,\n    dim_geografi.kommune_navn as bosted_kommune,\n    dim_alder.ungdomssatsing as alder_interval,\n    naering.gruppe5_besk_lang as naering,\n    CASE\n        WHEN dim_person1.fk_dim_kjonn = 5002 THEN 'K'\n        WHEN dim_person1.fk_dim_kjonn = 5001 THEN 'M'\n        ELSE 'U'\n    END as kjonn,\n    COUNT(CASE WHEN TRUNC(fakta_gen.DIALOGMOTE2_AVHOLDT_DATO) = TRUNC(gen_dato.dato) THEN 1 END) AS antall_dialogm\u00f8ter2,\n    COUNT(CASE WHEN TRUNC(fakta_gen.DIALOGMOTE3_AVHOLDT_DATO) = TRUNC(gen_dato.dato) THEN 1 END) AS antall_dialogm\u00f8ter3,\n    COUNT(CASE WHEN TRUNC(fakta_gen.unntak_dato) = TRUNC(gen_dato.dato) THEN 1 END) AS antall_unntak,\n    COUNT(CASE WHEN TRUNC(fakta_gen.dialogmote2_innen_26_uker_dato) = TRUNC(gen_dato.dato) THEN 1 END) AS ant_dialogmote2_innen_26_uker,\n    COUNT(CASE WHEN TRUNC(fakta_gen.dialogmote3_innen_39_uker_dato) = TRUNC(gen_dato.dato) THEN 1 END) AS ant_dialogmote3_innen_39_uker,\n    COUNT(CASE WHEN TRUNC(fakta_gen.unntak_innen_26_uker_dato) = TRUNC(gen_dato.dato) THEN 1 END) AS ant_unntak_innen_26_uker,\n    COUNT(CASE WHEN TRUNC(fakta_gen.behov_meldt_dato) = TRUNC(gen_dato.dato) THEN 1 END) AS antall_behov_meldt,\n    COUNT(CASE WHEN TRUNC(fakta_gen.behov_meldt_innen_26_uker_dato) = TRUNC(gen_dato.dato) THEN 1 END) AS ant_behov_meldt_innen_26_uker\nFROM\n    gen_dato\nINNER JOIN\n    fakta_gen ON trunc(gen_dato.dato) IN (trunc(fakta_gen.DIALOGMOTE2_AVHOLDT_DATO), trunc(fakta_gen.DIALOGMOTE3_AVHOLDT_DATO),\n    trunc(fakta_gen.unntak_dato),trunc(dialogmote2_innen_26_uker_dato), trunc(dialogmote3_innen_39_uker_dato),\n    trunc(dialogmote3_innen_39_uker_dato), trunc(unntak_innen_26_uker_dato),trunc(behov_meldt_innen_26_uker_dato), trunc(behov_meldt_dato))\nINNER JOIN\n    dim_org ON fakta_gen.fk_dim_organisasjon = dim_org.pk_dim_organisasjon\nINNER JOIN\n    dim_person1  ON fakta_gen.fk_person1 = dim_person1.fk_person1\n    and  dim_person1.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\ninner JOIN\n        dim_geografi ON dim_person1.fk_dim_geografi_bosted = dim_geografi.pk_dim_geografi\n        and  dim_person1.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\n        and  dim_geografi.gyldig_til_dato = TO_DATE('9999-12-31', 'YYYY-MM-DD')\ninner join\n    dim_alder  ON fakta_gen.fk_dim_alder = dim_alder.pk_dim_alder\ninner join\n    naering on  fakta_gen.fk_dim_naering = naering.pk_dim_naering\n    and naering.gyldig_flagg=1\nGROUP BY\n    EXTRACT(YEAR FROM gen_dato.dato),\n    EXTRACT(MONTH FROM gen_dato.dato),\n    TO_CHAR(gen_dato.dato, 'IW'),\n    dim_org.nav_nivaa2_navn,\n    dim_org.nav_enhet_navn,\n    dim_geografi.fylke_navn,\n    dim_geografi.kommune_navn,\n    dim_alder.ungdomssatsing,\n    naering.gruppe5_besk_lang,\n    CASE\n        WHEN dim_person1.fk_dim_kjonn = 5002 THEN 'K'\n        WHEN dim_person1.fk_dim_kjonn = 5001 THEN 'M'\n        ELSE 'U'\n    END\n)\nSELECT * FROM dialogm\u00f8ter_agg", "relation_name": "dvh_syfo.agg_fak_dialogmote_sub", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T12:31:02.570118Z", "completed_at": "2026-01-22T12:31:02.576277Z"}, {"name": "execute", "started_at": "2026-01-22T12:31:02.578267Z", "completed_at": "2026-01-22T12:31:02.578278Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024891376495361328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dmx_poc.syfo_fak_dialogmote", "compiled": true, "compiled_code": "with final as (\n select 1 from dvh_syfo.fak_dialogmote where tilfelle_startdato = to_date('1970-01-01','YYYY-MM-DD')\n)\nselect 1 from final", "relation_name": null, "batch_results": null}], "elapsed_time": 4.6466240882873535, "args": {"static": false, "strict_mode": false, "log_format": "default", "state_modified_compare_vars": false, "which": "generate", "invocation_command": "dbt docs generate", "require_resource_names_without_spaces": false, "empty_catalog": false, "log_format_file": "debug", "require_nested_cumulative_type_params": false, "use_colors": true, "log_level": "info", "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "populate_cache": true, "log_level_file": "debug", "show_resource_report": false, "partial_parse": true, "print": true, "indirect_selection": "eager", "source_freshness_run_project_hooks": false, "version_check": true, "project_dir": "/home/user/github/dvh-sykefravar-dmx", "select": [], "profiles_dir": "/home/user/github/dvh-sykefravar-dmx", "require_batched_execution_for_custom_microbatch_strategy": false, "compile": true, "favor_state": false, "cache_selected_only": false, "send_anonymous_usage_stats": false, "log_path": "/home/user/github/dvh-sykefravar-dmx/logs", "vars": {}, "partial_parse_file_diff": true, "skip_nodes_if_on_run_start_fails": false, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "log_file_max_bytes": 10485760, "use_colors_file": true, "state_modified_compare_more_unrendered_values": false, "printer_width": 80, "quiet": false, "introspect": true, "defer": false, "write_json": true, "macro_debugging": false}}